(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    299055,       7182]
NotebookOptionsPosition[    292163,       6986]
NotebookOutlinePosition[    292993,       7014]
CellTagsIndexPosition[    292950,       7011]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Miko\[LSlash]aj Go\[LSlash]u\:0144ski", "Author",
 CellChangeTimes->{{3.5913103266933055`*^9, 3.591310329338457*^9}}],

Cell[TextData[StyleBox["Przygotowane z u\:017cyciem programu Mathematica \
9.0.1",
 FontSlant->"Italic"]], "Department",
 CellChangeTimes->{{3.5913091168171043`*^9, 3.5913091712902203`*^9}, {
   3.591310640888276*^9, 3.5913106605233994`*^9}, 3.5913107508105636`*^9}],

Cell[CellGroupData[{

Cell["Symulacja toru optycznego", "Title",
 CellChangeTimes->{{3.591302441778314*^9, 3.5913024846897683`*^9}}],

Cell["\<\
z wykorzystaniem formalizmu ABCD\
\>", "Subtitle",
 CellChangeTimes->{{3.5913024859258394`*^9, 3.591302489035017*^9}, {
  3.5913110011738834`*^9, 3.591311002068935*^9}}],

Cell[CellGroupData[{

Cell["Wst\:0119p", "Section",
 CellChangeTimes->{{3.59130256461434*^9, 3.591302568023535*^9}}],

Cell[CellGroupData[{

Cell["Podstawowe informacje", "Subsection",
 CellChangeTimes->{{3.5913034755854445`*^9, 3.5913034809627523`*^9}}],

Cell["\<\
Optyka i fotonika s\:0105 szerokimi dziedzinami fizyki zajmuj\:0105cymi si\
\:0119 w\[LSlash]a\:015bciwo\:015bciami \:015bwiat\[LSlash]a oraz jego \
interakcji z otoczeniem. Zar\[OAcute]wno podczas prowadzenia bada\:0144 \
podstawowych jak i przy opracowywaniu zastosowa\:0144 dla danego zjawiska \
budowane s\:0105 r\[OAcute]\:017cnorodne tory optyczne. S\:0105 to zespo\
\[LSlash]y przyrz\:0105d\[OAcute]w optycznych s\[LSlash]u\:017c\:0105ce do \
takiej zmiany po\[LSlash]o\:017cenia oraz w\[LSlash]a\:015bciwo\:015bci wi\
\:0105zki aby odpowiada\[LSlash]a ona potrzebom badacza. Prawid\[LSlash]owe u\
\[LSlash]o\:017cenie wszystkich element\[OAcute]w toru zajmuje zwykle \
du\:017co czasu wi\:0119c praktyczne wydaje si\:0119 stworzenie symulacji \
takiego toru przed przyst\:0105pieniem do jego budowy aby sprawdzi\[CAcute] \
czy rzeczywi\:015bcie spe\[LSlash]ni on stawiane przed nim wymagania. Ponadto \
symulowanie zachowania element\[OAcute]w optycznych pozwala na \
dok\[LSlash]adniejsze zaplanowanie przeprowadzanego eksperymentu oraz \
ewentualne jego ulepszenie bez potrzeby \:017cmudnej kalibracji wszystkich \
element\[OAcute]w.\
\>", "Text",
 CellChangeTimes->{{3.591302588619713*^9, 3.5913026382865534`*^9}, {
  3.5913026695783434`*^9, 3.591302917870545*^9}, {3.591302997087076*^9, 
  3.5913034386863337`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formalizm ABCD", "Subsection",
 CellChangeTimes->{{3.5913034852179956`*^9, 3.5913034915143557`*^9}}],

Cell["\<\
Jednym ze sposob\[OAcute]w opisu element\[OAcute]w optycznych jest formalizm \
ABCD. Przypisuje on ka\:017cdemu z element\[OAcute]w konkretn\:0105 macierz \
charakteryzuj\:0105c\:0105 oddzia\[LSlash]ywanie danego elementu z wi\:0105zk\
\:0105 \:015bwiat\[LSlash]a. Z\[LSlash]o\:017cenie wielu element\[OAcute]w mo\
\:017cna wtedy opisa\[CAcute] poprzez proste wymno\:017cenie macierzy \
kolejnych element\[OAcute]w z zachowaniem odwrotnej kolejno\:015bci macierzy \
w stosunku do kolejno\:015bci element\[OAcute]w. Na przyk\[LSlash]ad, \
je\:015bli tor optyczny sk\[LSlash]ada si\:0119 z soczewki, apertury i pustej \
przestrzeni (w tej kolejno\:015bci) to macierz przej\:015bcia dla takiego \
toru by\[LSlash]aby iloczynem macierzy pustej przestrzeni, apertury i \
soczewki (tak\:017ce w tej kolejno\:015bci).\
\>", "Text",
 CellChangeTimes->{{3.5913035039820685`*^9, 3.5913035612743454`*^9}, {
  3.5913036200787086`*^9, 3.5913039666455317`*^9}, {3.591303996950265*^9, 
  3.591303997528298*^9}}],

Cell["\<\
W projekcie wykorzystano prosty model, kt\[OAcute]ry znacz\:0105co upraszcza \
obliczenia. Sprowadza on ka\:017cdy element optyczny do macierzy 2x2 gdzie \
kolejne elemnty macierzy nazywane s\:0105 literami A, B, C i D. Wprowadza \
jednak par\:0119 przybli\:017ce\:0144, z kt\[OAcute]rych najwa\:017cniejsze \
to:\
\>", "Text",
 CellChangeTimes->{{3.5913039990283833`*^9, 3.5913040049707236`*^9}, {
  3.5913049933272543`*^9, 3.5913049981025276`*^9}, {3.5913054460391483`*^9, 
  3.5913055034754333`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Przybli\:017cenie Gaussowskie\[LineSeparator]Fala \:015bwietlna ma kszta\
\[LSlash]t Gaussowski. Ponadto niekt\[OAcute]re elementy, np. apertura, nie \
maj\:0105 ostrych kraw\:0119dzi a raczej wyg\[LSlash]adzone tak, \:017ce \
odpowiadaj\:0105 opisowi Gaussowskiemu.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.5913040460230713`*^9, 3.591304265354617*^9}, {
  3.5913043317394133`*^9, 3.5913043334735126`*^9}}],

Cell["\<\
Przybli\:017cenie przyosiowe (przybli\:017cenie ma\[LSlash]ych k\:0105t\
\[OAcute]w)\[LineSeparator]K\:0105t mi\:0119dzy osi\:0105 optyczn\:0105 a \
kierunkiem padania wi\:0105zki \:015bwiat\[LSlash]a \[Theta] jest \
ma\[LSlash]y. K\:0105t ten powinien by\[CAcute] na tyle ma\[LSlash]y, \:017ce \
sin \[Theta] \[TildeTilde] \[Theta] oraz cos \[Theta] \[TildeTilde] 1. \
Odchylenie tego przybli\:017cenia od rzeczywisto\:015bci silnie ro\:015bnie \
razem z k\:0105tem. Mimo to, dla zastosowa\:0144 praktycznych, mo\:017cna je \
stosowa\[CAcute] nawet do k\:0105ta r\[OAcute]wnego 30 stopni (chocia\:017c \
wtedy b\[LSlash]\:0105d wynosi a\:017c oko\[LSlash]o 15%).\
\>", "ItemNumbered",
 CellChangeTimes->{{3.5913039779561787`*^9, 3.5913040164863825`*^9}, {
  3.591304302742755*^9, 3.5913043654583426`*^9}, {3.591304717555481*^9, 
  3.591304972063038*^9}, {3.5913050352186503`*^9, 3.591305035224651*^9}, {
  3.591305201586166*^9, 3.5913052015921664`*^9}}],

Cell["\<\
Przybli\:017cenie cylindryczne\[LineSeparator]Tor optyczny mo\:017ce by\
\[CAcute] opisany z u\:017cyciem cylindrycznego uk\[LSlash]adu wsp\[OAcute]\
\[LSlash]rz\:0119dnych. Oznacza to, \:017ce uk\[LSlash]ad jest cylindrycznie \
symetryczny.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.5913039779561787`*^9, 3.5913040164863825`*^9}, {
  3.591304302742755*^9, 3.5913043654583426`*^9}, {3.591304717555481*^9, 
  3.591304972063038*^9}, {3.5913050352186503`*^9, 3.591305035224651*^9}, {
  3.591305201586166*^9, 3.591305295730551*^9}}],

Cell["\<\
Krzywizna element\[OAcute]w optycznych jest maksymalnie drugiego stopnia\
\[LineSeparator]Krzywizna wykorzystywanych element\[OAcute]w optycznych musi \
by\[CAcute] opisana r\[OAcute]wnaniem najwy\:017cej drugiego stopnia.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.5913039779561787`*^9, 3.5913040164863825`*^9}, {
   3.591304302742755*^9, 3.5913043654583426`*^9}, {3.591304717555481*^9, 
   3.591304972063038*^9}, 3.5913050352186503`*^9, {3.5913050655023823`*^9, 
   3.591305196482874*^9}, 3.5913052295547657`*^9}]
}, Open  ]],

Cell["\<\
Pomimo powy\:017cszych zastrze\:017ce\:0144 ten prosty model ca\[LSlash]kiem \
dobrze opisuje rzeczywisto\:015b\[CAcute] i mo\:017ce zosta\[CAcute] \
zastosowany przy wielu obliczeniach.
Istniej\:0105 poszerzenia formalizmu ABCD pozwalaj\:0105ce na \
dok\[LSlash]adniejsze opisanie element\[OAcute]w optycznych. Prowadz\:0105 \
one jednak do znacznego skomplikowania oblicze\:0144 na przyk\[LSlash]ad \
rozszerzaj\:0105c macierze element\[OAcute]w do rozmiar\[OAcute]w 4x4.\
\>", "Text",
 CellChangeTimes->{{3.5913053113354435`*^9, 3.591305429034175*^9}, {
  3.5913055171942177`*^9, 3.59130559765882*^9}}],

Cell["\<\
Dzi\:0119ki sprowadzeniu ca\[LSlash]ego zespo\[LSlash]u element\[OAcute]w \
optycznych do jednej macierzy przej\:015bcia mo\:017cna wykorzysta\[CAcute] \
elementy tej macierzy do obliczenia wielorakich w\[LSlash]a\:015bciwo\:015bci \
\:015bwiat\[LSlash]a przechodz\:0105cego przez skonstruowany tor optyczny. W \
projekcie obliczane s\:0105 podstawowe parametry wi\:0105zki takie jak jej po\
\[LSlash]o\:017cenie i k\:0105t, pod kt\[OAcute]rym wychodzi z \
uk\[LSlash]adu, jej szeroko\:015b\[CAcute], k\:0105t zakrzywienia frontu wi\
\:0105zki oraz przesuni\:0119cie fazowe. Mo\:017cliwe jest jednak \
zastosowanie macierzy ABCD do specjalistycznych oblicze\:0144, z \
kt\[OAcute]rych jednym z wielu przyk\[LSlash]ad\[OAcute]w jest znajdowanie \
statystycznych wielko\:015bci zwi\:0105zanych z badaniem szumu \
c\:0119tkowanego (ang. speckles).\
\>", "Text",
 CellChangeTimes->{{3.591305632551816*^9, 3.5913060511827602`*^9}, {
  3.591306224466672*^9, 3.5913062258667517`*^9}, {3.591306301332068*^9, 
  3.5913063239153595`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Opis programu", "Subsection",
 CellChangeTimes->{{3.591306402936879*^9, 3.5913064101552925`*^9}}],

Cell["\<\
Projekt sk\[LSlash]ada si\:0119 z pojedynczego programu pozwalaj\:0105cego na \
ustawienie parametr\[OAcute]w zastosowanej wi\:0105zki laserowej oraz \
zbudowanie toru optycznego z dost\:0119pnych element\[OAcute]w. \
Nast\:0119pnie oblicza on macierz ABCD dla danego uk\[LSlash]adu oraz \
podstawowe w\[LSlash]a\:015bciwo\:015bci wi\:0105zki wyj\:015bciowej. Dla u\
\[LSlash]atwienia korzystania z programu generowana jest wizualizacja toru \
optycznego sk\[LSlash]adaj\:0105ca si\:0119 z symbolicznego przedstawienia \
zastosowanych element\[OAcute]w optycznych oraz promienia na wej\:015bciu i \
wyj\:015bciu uk\[LSlash]adu. Program pozwala na symulacj\:0119 w jednym \
wymiarze, tzn. okre\:015blana jest jedynie wysoko\:015b\[CAcute] po\[LSlash]o\
\:017cenia wi\:0105zki (okre\:015blenie po\[LSlash]o\:017cenia w jednym \
wymiarze).\
\>", "Text",
 CellChangeTimes->{{3.591306414527542*^9, 3.591306507394854*^9}, {
  3.5913065405027475`*^9, 3.591306622751452*^9}, {3.5913066594035482`*^9, 
  3.5913073625577664`*^9}}],

Cell[TextData[{
 "Program przygotowano tak, aby m\[OAcute]g\[LSlash] by\[CAcute] zapisany do \
formatu CDF. Pozwala to na upublicznienie programu dla os\[OAcute]b, kt\
\[OAcute]re nie posiadaj\:0105 oprogramowania ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ". Pliki CDF mo\:017cna otwiera\[CAcute] i z nich korzysta\[CAcute] przy \
pomocy darmowej przegl\:0105darki tego typu plik\[OAcute]w dost\:0119pnej na \
stronie Wolfram. Ponadto mo\:017cliwe jest zamieszczenie tak przygotowanego \
programu na stronie intenetowej i korzystanie z niego za pomoc\:0105 wtyczki \
do przegl\:0105darki internetowej, kt\[OAcute]ra tak\:017ce jest \
dost\:0119pna na stronie firmy Wolfram."
}], "Text",
 CellChangeTimes->{{3.591307794421468*^9, 3.5913080276628084`*^9}}],

Cell["\<\
Wszystkie grafiki zosta\[LSlash]y przygotowane bezpo\:015brednio w \
Mathematice. Bazowano na strukturze Dynamic z pomini\:0119ciem mo\:017cliwo\
\:015bci funkcji Manipulate poza funkcjami niezb\:0119dnymi do stworzenia \
wersji programu mog\:0105cej by\[CAcute] wyeksportowan\:0105 do pliku .cdf. \
Zdecydowano si\:0119 na stworzenie indywidualnych kontrolek i przycisk\
\[OAcute]w aby omin\:0105\[CAcute] ograniczenia wynikaj\:0105ce z funkcji \
Manipulate, g\[LSlash]\[OAcute]wnie dotycz\:0105ce po\[LSlash]o\:017cenia \
oraz wygl\:0105du kontrolek.\
\>", "Text",
 CellChangeTimes->{{3.5913073651599154`*^9, 3.5913076234796906`*^9}}],

Cell["\<\
Program mo\:017ce by\[CAcute] rozwini\:0119ty na wiele sposob\[OAcute]w, \
m.in. poprzez dodanie wi\:0119kszej ilo\:015bci dost\:0119pnych element\
\[OAcute]w, zwi\:0119kszenie ilo\:015bci obliczanych w\[LSlash]a\:015bciwo\
\:015bci i ich pogrupowanie wed\[LSlash]ug specjalizacji lub te\:017c \
wprowadzenie drugiego wymiaru. Mo\:017cna tak\:017ce uatrakcyjni\[CAcute] \
wizualizacj\:0119 wprowadzaj\:0105c tor wi\:0105zki w samym torze optycznym, \
dynamicznie tworzone elementy (np. zmienn\:0105 krzywizn\:0119 soczewek w \
zale\:017cno\:015bci od krzywizny wprowadzonej przy dodawaniu elementu) oraz \
widoczn\:0105 zmian\:0119 wsp\[OAcute]\[LSlash]czynnika za\[LSlash]amania dla \
element\[OAcute]w gdzie jest ona okre\:015blana.\
\>", "Text",
 CellChangeTimes->{{3.591306414527542*^9, 3.591306507394854*^9}, {
  3.5913065405027475`*^9, 3.591306622751452*^9}, {3.5913066594035482`*^9, 
  3.5913073586245413`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kod programu", "Section",
 CellChangeTimes->{{3.5913025765790243`*^9, 3.5913025835304217`*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.5882604214454527`*^9, 3.5882604279738255`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"yout", "[", 
    RowBox[{"in_", ",", "ABCD_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ABCD", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{"in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"ABCD", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{
      "in", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]out", "[", 
    RowBox[{"in_", ",", "ABCD_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ABCD", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{"in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     "+", 
     RowBox[{
      RowBox[{"ABCD", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
      RowBox[{
      "in", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outFun", "[", 
    RowBox[{"in_", ",", "ABCD_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"yout", "[", 
      RowBox[{"in", ",", "ABCD"}], "]"}], ",", 
     RowBox[{"\[Phi]out", "[", 
      RowBox[{"in", ",", "ABCD"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.588007505023999*^9, 3.5880075206968956`*^9}, {
  3.5880076715595245`*^9, 3.588007680591041*^9}, {3.588007760229596*^9, 
  3.5880077886492214`*^9}, {3.5880078690198183`*^9, 3.588007958112914*^9}, {
  3.5880124939823513`*^9, 3.58801256092918*^9}, {3.588013046931978*^9, 
  3.5880130490831013`*^9}, {3.591210036689522*^9, 3.591210046385076*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]out", "[", 
    RowBox[{"\[Omega]in_", ",", "ABCD_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{"\[Omega]in", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ABCD", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"ABCD", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/", 
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"\[Omega]in", "^", "2"}]}], ")"}]}]}], ")"}], "^", 
        "2"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rout", "[", 
     RowBox[{"\[Omega]in_", ",", "ABCD_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Re", "[", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "\[Omega]in", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "/", 
           RowBox[{
           "\[Omega]in", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ")"}], "^", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ABCD", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"ABCD", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{
           RowBox[{"ABCD", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"ABCD", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "/", 
              RowBox[{"(", 
               RowBox[{"k", " ", 
                RowBox[{
                "\[Omega]in", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "^", "2"}]}]}], 
         ")"}]}], ")"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"\[Omega]in", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Omega]in", ",", " ", "\[Omega]out"}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]out", "[", 
    RowBox[{"\[Omega]in_", ",", "ABCD_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", "k"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"ABCD", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"\[Omega]in", "^", "2"}], " ", 
         RowBox[{"ABCD", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}]}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.591124812762287*^9, 3.5911253323820076`*^9}, {
  3.5911852973865147`*^9, 3.5911853026828175`*^9}, {3.59120879935175*^9, 
  3.591208803238972*^9}, {3.591213220991909*^9, 3.5912132313465014`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"radToDeg", "[", "rad_", "]"}], ":=", 
   RowBox[{"180", " ", 
    RowBox[{"rad", "/", "\[Pi]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"degToRad", "[", "deg_", "]"}], ":=", 
   RowBox[{"\[Pi]", " ", 
    RowBox[{"deg", "/", "180"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5880088412454267`*^9, 3.588008891221285*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]tok", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kto\[Lambda]", "[", "k_", "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "k"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5911782840503745`*^9, 3.5911783285459194`*^9}, {
  3.5911784665408125`*^9, 3.591178476898405*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rToF", "[", "r_", "]"}], ":=", 
   FractionBox[
    RowBox[{"n1", " ", "n2", " ", 
     SuperscriptBox["r", "2"]}], 
    RowBox[{"d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n2"}], ")"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fToR", "[", "f_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     SqrtBox["d"], " ", 
     SqrtBox["f"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n2"}], ")"}]}], 
    RowBox[{
     SqrtBox["n1"], " ", 
     SqrtBox["n2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rToFMirror", "[", "r_", "]"}], ":=", 
   RowBox[{"r", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fToRMirror", "[", "f_", "]"}], ":=", 
   RowBox[{"2", "f"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.590257536496588*^9, 3.590257546653169*^9}, {
  3.5902576194393325`*^9, 3.5902576235105653`*^9}, {3.5902576985058546`*^9, 
  3.5902577037621555`*^9}, {3.590257828993318*^9, 3.5902578304884033`*^9}, {
  3.5903249541413226`*^9, 3.590324988217272*^9}, {3.5912078600270233`*^9, 
  3.591207906384675*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"appendGraphics", "[", "primitive_", "]"}], ":=", 
   RowBox[{"graphics", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"graphics", "\[LeftDoubleBracket]", 
       RowBox[{";;", 
        RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Translate", "[", 
        RowBox[{"primitive", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "graphics", "]"}], "-", "1"}], ",", "0"}], 
          "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"graphics", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prependGraphics", "[", "primitive_", "]"}], ":=", 
   RowBox[{"graphics", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "graphics", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Translate", "[", 
        RowBox[{"primitive", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Translate", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"graphics", "\[LeftDoubleBracket]", 
        RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5880130009893503`*^9, 3.5880130609997826`*^9}, 
   3.588248074531249*^9, {3.5882515879782066`*^9, 3.5882515961396737`*^9}, {
   3.5882603646042013`*^9, 3.5882603904286785`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"insertAfterGraphics", "[", 
    RowBox[{"primitive_", ",", "index_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"graphics", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"graphics", "\[LeftDoubleBracket]", 
       RowBox[{";;", 
        RowBox[{"index", "+", "1"}]}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Translate", "[", 
        RowBox[{"primitive", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"index", "+", "1"}], ",", "0"}], "}"}]}], "]"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Translate", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"graphics", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"index", "+", "2"}], ";;"}], "\[RightDoubleBracket]"}]}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588682901935711*^9, 3.5886829289572563`*^9}, {
  3.588682981972289*^9, 3.588683166866864*^9}, {3.588683201016817*^9, 
  3.5886832197048864`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"insertAfterParameters", "[", 
   RowBox[{"parameters_", ",", "index_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "gParameters", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gParameters", "=", 
      RowBox[{"{", "parameters", "}"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gParameters", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"gParameters", "\[LeftDoubleBracket]", 
         RowBox[{";;", "index"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", "parameters", "}"}], ",", 
        RowBox[{"gParameters", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"index", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5888598493333635`*^9, 3.588859945403858*^9}, {
  3.5888601409310417`*^9, 3.5888601438722095`*^9}, {3.5888602310361953`*^9, 
  3.588860233720349*^9}, {3.588860310683751*^9, 3.588860329605833*^9}, {
  3.5888603999638577`*^9, 3.5888604354568872`*^9}, {3.588860515663475*^9, 
  3.5888605177675953`*^9}}],

Cell[BoxData[
 RowBox[{"clearVariablesAdd", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"input", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"hardware", "=."}], ";", "\[IndentingNewLine]", 
    RowBox[{"deleteNum", "=", "\"\<Choose\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"positionAdd", "=", 
     RowBox[{
      RowBox[{"Length", "[", "graphics", "]"}], "-", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"airQ", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rQ", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"fInput", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.588261098133157*^9, 3.5882611032864513`*^9}, {
   3.588340131465299*^9, 3.588340136618594*^9}, {3.588597049255094*^9, 
   3.5885970551544313`*^9}, {3.5886846782033076`*^9, 3.588684682122532*^9}, {
   3.590328814022095*^9, 3.590328820361458*^9}, {3.590831664353079*^9, 
   3.59083166804429*^9}, {3.590834277597548*^9, 3.5908342837088976`*^9}, {
   3.591179094007701*^9, 3.5911790941367087`*^9}, {3.5911791942074327`*^9, 
   3.5911792110593967`*^9}, {3.5911853424120893`*^9, 
   3.5911853455562696`*^9}, {3.5911867910729485`*^9, 3.5911868036556683`*^9}, 
   3.5912112350700645`*^9}],

Cell[BoxData[
 RowBox[{"clearAll", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ABCD", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ABCDElements", "=", 
     RowBox[{"{", "ABCD", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"in", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"out", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"graphics", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"graphicsBeamIn", "[", "in", "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"graphicsBeamOut", "[", "out", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yin", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"yinBuffer", "=", "yin"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]in", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]inBuffer", "=", "\[Phi]in"}], ";", "\[IndentingNewLine]", 
    RowBox[{"gParameters", "=", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]Q", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]in", "=", "695"}], ";", "\[IndentingNewLine]", 
    RowBox[{"kin", "=", 
     RowBox[{"\[Lambda]tok", "[", "\[Lambda]in", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Omega]in", "=", "1"}], ";", "\[IndentingNewLine]", 
    "clearVariablesAdd", ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.588260756782633*^9, 3.588260784644226*^9}, {
   3.5882609037470384`*^9, 3.5882609297995286`*^9}, {3.5882612390802183`*^9, 
   3.5882612569342394`*^9}, {3.5883401149883566`*^9, 3.588340124409896*^9}, {
   3.588597033669203*^9, 3.5885970428587284`*^9}, {3.5886013208864174`*^9, 
   3.5886013247886405`*^9}, {3.5886846962113376`*^9, 
   3.5886846978404307`*^9}, {3.5888597092593513`*^9, 
   3.5888597269943657`*^9}, {3.5888597891309195`*^9, 3.588859789295929*^9}, {
   3.5902610651114135`*^9, 3.590261077426118*^9}, {3.591186783201498*^9, 
   3.591186806954857*^9}, {3.5911868946898746`*^9, 3.591186910120757*^9}, 
   3.5912062220103345`*^9, {3.591206402749672*^9, 3.5912064031066923`*^9}, {
   3.5912128812434764`*^9, 3.5912128852657065`*^9}}],

Cell[BoxData[
 RowBox[{"clearElements", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"clearVariablesAdd", ";", "\[IndentingNewLine]", 
    RowBox[{"ABCD", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ABCDElements", "=", 
     RowBox[{"{", "ABCD", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"graphics", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"graphicsBeamIn", "[", "in", "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"graphicsBeamOut", "[", "out", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gParameters", "=", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "clearVariablesAdd", ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.591206422243787*^9, 3.5912064800850954`*^9}, {
  3.591206752885699*^9, 3.591206752996705*^9}, {3.5912153670136547`*^9, 
  3.591215393769185*^9}}],

Cell[BoxData[
 RowBox[{"clearInput", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"in", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"out", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"yin", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"yinBuffer", "=", "yin"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]in", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]inBuffer", "=", "\[Phi]in"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]Q", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]in", "=", 
     RowBox[{"695", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]inBuffer", "=", 
     RowBox[{"\[Lambda]in", "*", 
      RowBox[{"10", "^", "6"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kin", "=", 
     RowBox[{"\[Lambda]tok", "[", "\[Lambda]in", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kinBuffer", "=", 
     RowBox[{"kin", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Omega]in", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.5912064297792177`*^9, 3.591206448035262*^9}, {
  3.591206518743306*^9, 3.591206538072412*^9}, {3.591211890928578*^9, 
  3.591211932188938*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initializations", "Subsection",
 CellChangeTimes->{{3.5882604960937223`*^9, 3.5882605032071285`*^9}}],

Cell[BoxData[
 RowBox[{"clearAll", ";"}]], "Input",
 CellChangeTimes->{{3.588258037086075*^9, 3.5882580446085052`*^9}, {
  3.5882581202978344`*^9, 3.588258125691143*^9}, {3.588260792312665*^9, 
  3.588260794259776*^9}, {3.5912064070389175`*^9, 3.5912064073519354`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sizeHardware", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "220"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizePaneAdd1", "=", 
   RowBox[{"{", 
    RowBox[{"140", ",", "220"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizePaneAddMain", "=", 
   RowBox[{"{", 
    RowBox[{"260", ",", "210"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizePaneDelete", "=", 
   RowBox[{"{", 
    RowBox[{"260", ",", "69"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeInputFieldHardware", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeInputFieldIn", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeVisualisation", "=", 
   RowBox[{"{", 
    RowBox[{"400", ",", "200"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"degQ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"degQBuffer", "=", "degQ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"airQ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"airQBuffer", "=", "airQ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]Buffer", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5886835554960923`*^9, 3.588683615399519*^9}, {
   3.5886836952700872`*^9, 3.588683707721799*^9}, {3.5886837453309507`*^9, 
   3.588683788565423*^9}, {3.5888568205961294`*^9, 3.588856825175391*^9}, 
   3.5888569563948965`*^9, {3.58885841947558*^9, 3.5888584328213434`*^9}, {
   3.588870985697943*^9, 3.588870986061964*^9}, {3.588871022579053*^9, 
   3.5888710232520914`*^9}, {3.588871085544654*^9, 3.5888710875307674`*^9}, {
   3.5888711661702657`*^9, 3.5888711800200577`*^9}, {3.5902316341792994`*^9, 
   3.590231639053578*^9}, {3.5902541406653576`*^9, 3.590254168410945*^9}, {
   3.5902544689821367`*^9, 3.5902544706572323`*^9}, {3.5902550495053406`*^9, 
   3.5902550516904655`*^9}, {3.5902553873496637`*^9, 3.590255400134395*^9}, {
   3.590327539269183*^9, 3.590327549373761*^9}, {3.590327750561269*^9, 
   3.5903277525893846`*^9}, 3.5903283161026154`*^9, {3.5903286747901316`*^9, 
   3.5903286757941885`*^9}, {3.5907775560782633`*^9, 
   3.5907775659668293`*^9}, {3.5911790702033396`*^9, 3.5911790703483477`*^9}, 
   3.5911791610035334`*^9, {3.591186760003171*^9, 3.5911867757070694`*^9}, {
   3.5911868788769703`*^9, 3.5911869120798693`*^9}, 3.591187978704877*^9, 
   3.591205262068429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics definitions", "Subsection",
 CellChangeTimes->{{3.588260570062953*^9, 3.5882605770343513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsElementNumberText", ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "graphics", "]"}], "\[Equal]", "2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Element number:\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"FontSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{".5", ",", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588861069138132*^9, 3.5888611236452494`*^9}, 
   3.5888611574871855`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsNumbers", ":=", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Text", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToString", "[", "i", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FontSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "+", ".5"}], ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"Length", "[", "graphics", "]"}], "-", "2"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5888588055296607`*^9, 3.588858828310964*^9}, {
  3.5888592427126665`*^9, 3.5888592447897854`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsParameters", ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", "gParameters", "]"}], "\[Equal]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Text", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"gParameters", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j", ",", "1"}], "\[RightDoubleBracket]"}], 
               "<>", "\"\< = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"gParameters", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", "2"}], "\[RightDoubleBracket]"}],
                 "]"}], "<>", "\"\<\\n\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "gParameters", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FontSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "+", ".5"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "gParameters", "]"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588858862058894*^9, 3.588858872337482*^9}, {
   3.588859092174056*^9, 3.588859105761833*^9}, {3.588859162545081*^9, 
   3.5888593555451202`*^9}, {3.5888594090541806`*^9, 3.588859422382943*^9}, {
   3.5888594999693804`*^9, 3.5888595028905478`*^9}, {3.588860999854169*^9, 
   3.5888610253666286`*^9}, 3.588861161959441*^9, {3.588861264291294*^9, 
   3.588861283303382*^9}, {3.588871905174534*^9, 3.5888719099148054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"graphicsBeamIn", "[", "in_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Rotate", "[", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
             "in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{
             "in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"in", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
          "in", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "]"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5885973857683415`*^9, 3.588597385818344*^9}, {
  3.5886012193576107`*^9, 3.58860122512494*^9}, {3.588860636718399*^9, 
  3.5888606631009083`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"graphicsBeamOut", "[", "out_", "]"}], ":=", 
   RowBox[{"Rotate", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
          "out", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
          "out", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"out", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
       "out", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588601229021163*^9, 3.5886012432229753`*^9}, 
   3.5886013013923025`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextFreeSpace", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<d\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".1"}], ",", ".1"}], "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588250349254356*^9, 3.5882505998516893`*^9}, {
   3.5882506832834616`*^9, 3.588250718944501*^9}, {3.588250751312352*^9, 
   3.5882508873281317`*^9}, {3.5882510947959986`*^9, 3.588251194236686*^9}, 
   3.588251274098254*^9, 3.588251461612979*^9, {3.588258632527132*^9, 
   3.5882586347542596`*^9}, {3.5882589225337195`*^9, 
   3.5882589276090097`*^9}, {3.5882590076085854`*^9, 3.588259036658247*^9}, {
   3.5907636424024467`*^9, 3.5907636425544558`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextSlab", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<d\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".1"}], ",", ".1"}], "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907654524339743`*^9, 3.590765519457808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsFreeSpace", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"White", ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882586884303293`*^9, 3.588258699832982*^9}, 
   3.5882589330663223`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextThinLensAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<f\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590763018502762*^9, 3.5907630294943905`*^9}, {
   3.590763059683117*^9, 3.5907630703227253`*^9}, {3.590763129551113*^9, 
   3.5907631321582623`*^9}, 3.5907636497478666`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextThinLens", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<f\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590763225455599*^9, 3.5907632286157794`*^9}, {
  3.590763652548027*^9, 3.590763653404076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsThinLens", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907630818743863`*^9, 3.590763085706606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextThickLensAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<f\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<d\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".1"}], ",", ".1"}], "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "10"}], "-", "0.15"}], ")"}]}], ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "/", "10"}], "-", "0.15"}], ",", "0"}], "}"}]}], 
         "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.15"}], ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907632789396577`*^9, 3.590763295123584*^9}, {
  3.5907636579753375`*^9, 3.590763660167463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextThickLens", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<f\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<d\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".1"}], ",", ".1"}], "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "10"}], "-", "0.15"}], ")"}]}], ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"3", "/", "10"}], "-", "0.15"}], ",", "0"}], "}"}]}], 
         "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.15"}], ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590763713001485*^9, 3.5907637170417156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsThickLens", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.15"}], ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Translate", "[", 
       RowBox[{
        RowBox[{"BSplineCurve", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0"}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "-", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "0.15"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590763727348305*^9, 3.5907637474044523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextFlatInterfaceInAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907640887029734`*^9, 3.5907641030937967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextFlatInterfaceIn", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590764173158804*^9, 3.5907641760109673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextFlatInterfaceOutAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590764210901963*^9, 3.590764216238268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextFlatInterfaceOut", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.9", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.35", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59076429809195*^9, 3.5907643023181915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsFlatInterface", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907641115102777`*^9, 3.5907641201657734`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextCurvedInterfaceInAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", ".1", "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "4"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "10"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907643639287157`*^9, 3.5907643787105613`*^9}, {
  3.5907654012960496`*^9, 3.59076540164707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextCurvedInterfaceIn", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", ".1", "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "4"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", "/", "10"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590764424260166*^9, 3.5907644258042545`*^9}, {
  3.590765407896427*^9, 3.590765408208445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsCurvedInterfaceIn", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907644379679503`*^9, 3.5907644515777287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextCurvedInterfaceOutAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<n\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", ".1", "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"3", "/", "4"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"3", "/", "10"}]}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5907645444180393`*^9, 3.590764566426298*^9}, {
  3.590765412647699*^9, 3.590765412855711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsTextCurvedInterfaceOut", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.9", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "Large", ",", 
          "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", ".1", "}"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"3", "/", "4"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"3", "/", "10"}]}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590764613303979*^9, 3.590764617264206*^9}, {
  3.5907654153048506`*^9, 3.5907654155118628`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsCurvedInterfaceOut", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"1", "/", "10"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590764624016592*^9, 3.590764628460846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsFlatMirrorAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.591207427932309*^9, 3.591207542220846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsCurvedMirrorAirText", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], "+", 
            RowBox[{"1", "/", "10"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Arrowheads", "[", 
        RowBox[{"{", ".1", "}"}], "]"}], ",", 
       RowBox[{"Translate", "[", 
        RowBox[{
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"3", "/", "4"}]}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"3", "/", "10"}]}], ",", "0"}], "}"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "50"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<r\>\"", ",", "Large", ",", "Italic"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"1", "/", "6"}]}], "}"}]}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5912069308788795`*^9, 3.5912069747823906`*^9}, {
  3.59120701830488*^9, 3.5912070342367907`*^9}, {3.5912070787163353`*^9, 
  3.591207215915182*^9}, {3.59120727252742*^9, 3.591207349013795*^9}, {
  3.5912074131234617`*^9, 3.5912074146755505`*^9}, {3.59120745451883*^9, 
  3.5912074550868626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsCurvedMirrorAir", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], "+", 
            RowBox[{"1", "/", "10"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.591207353551055*^9, 3.591207422737012*^9}, {
  3.591207460081148*^9, 3.5912074604801707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphicsNone", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], "]"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882512635826526`*^9, 3.588251327094285*^9}, 
   3.5882514592018414`*^9, 3.5882514971720133`*^9, {3.588258622806576*^9, 
   3.588258628530904*^9}, {3.5882588484124804`*^9, 3.588258849164523*^9}, {
   3.5882588814293685`*^9, 3.588258911306077*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix definitions", "Subsection",
 CellChangeTimes->{{3.5882609475665445`*^9, 3.588260954914965*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrixFreeSpace", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "d"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixSlab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"d", "/", "n"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixLens", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "f"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixThickLensAir", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"d", "-", 
          RowBox[{"d", " ", "n"}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", "r"}]]}], ",", 
       FractionBox["d", 
        SuperscriptBox["n", "2"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"d", "-", 
            RowBox[{"d", " ", "n"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["n", "2"], " ", "r"}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["r", "2"]}]]}], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"d", "-", 
          RowBox[{"d", " ", "n"}]}], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", "r"}]]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixThickLens", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n1", "-", "n2"}], ")"}]}], 
         RowBox[{
          SuperscriptBox["n2", "2"], " ", "r"}]]}], ",", 
       FractionBox[
        RowBox[{"d", " ", "n1"}], 
        SuperscriptBox["n2", "2"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n1", "-", "n2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"n1", "-", "n2"}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["n2", "2"], " ", "r"}]}], ")"}]}], 
        RowBox[{"n1", " ", 
         SuperscriptBox["n2", "2"], " ", 
         SuperscriptBox["r", "2"]}]], ",", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n1", "-", "n2"}], ")"}]}], 
         RowBox[{
          SuperscriptBox["n2", "2"], " ", "r"}]]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixFlatInterfaceInAir", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "n"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixFlatInterfaceIn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"n1", "/", "n2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixFlatInterfaceOutAir", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"n", "/", "1"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixFlatInterfaceOut", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"n1", "/", "n2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixCurvedInterfaceInAir", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r"}], " ", "n"}], ")"}]}], ",", 
       RowBox[{"1", "/", "n"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixCurvedInterfaceIn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n2", "-", "n1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r"}], " ", "n2"}], ")"}]}], ",", 
       RowBox[{"n1", "/", "n2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixCurvedInterfaceOutAir", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "n"}], ")"}], "/", 
        RowBox[{"(", "r", ")"}]}], ",", 
       RowBox[{"n", "/", "1"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixCurvedInterfaceOut", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n1", "-", "n2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"r", " ", "n1"}], ")"}]}], ",", 
       RowBox[{"n2", "/", "n1"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixFlatMirror", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixCurvedMirror", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "/", "r"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixApperture", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], 
        RowBox[{"\[ImaginaryI]", "/", 
         RowBox[{"(", 
          RowBox[{"k", " ", 
           RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}]}], ",", "1"}], "}"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5886813194621983`*^9, 3.5886813314928865`*^9}, {
   3.5886814137115893`*^9, 3.5886815453191166`*^9}, {3.5886817024121017`*^9, 
   3.5886817105425673`*^9}, {3.588681782313672*^9, 3.5886818463073325`*^9}, {
   3.5886822030227356`*^9, 3.588682209121084*^9}, {3.588682372025402*^9, 
   3.5886824112786465`*^9}, 3.588682473821224*^9, {3.5886827956596327`*^9, 
   3.5886828448004427`*^9}, {3.590256398277486*^9, 3.5902566317948422`*^9}, {
   3.590257276160698*^9, 3.5902572837121296`*^9}, 3.590257399423748*^9, {
   3.5902581305945687`*^9, 3.5902581364489036`*^9}, {3.5902581884778795`*^9, 
   3.5902582164814816`*^9}, 3.5908365602391076`*^9, {3.5908365993233433`*^9, 
   3.590836609339916*^9}, 3.590836947440254*^9, {3.590837053281308*^9, 
   3.5908370890013514`*^9}, {3.590837189068074*^9, 3.5908372008187466`*^9}, {
   3.5908373297681217`*^9, 3.590837352043396*^9}, {3.5908376570178394`*^9, 
   3.5908376586249313`*^9}, {3.590851081870621*^9, 3.590851085116807*^9}, {
   3.5908514501706867`*^9, 3.590851451313752*^9}, 3.5908515681474347`*^9, 
   3.590851630411996*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functionalities", "Subsection",
 CellChangeTimes->{{3.588260648011411*^9, 3.588260655178821*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"switchHardware", ":=", "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "hardware", ",", "\[IndentingNewLine]", "\"\<Choose\>\"", ",", 
     "\[IndentingNewLine]", "paneNone", ",", "\[IndentingNewLine]", 
     "\"\<Free space\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneFreeSpace"}], ",", "\[IndentingNewLine]", "\"\<Slab\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "2"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneSlab"}], ",", "\[IndentingNewLine]", 
     "\"\<Thin lens\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneLens"}], ",", "\[IndentingNewLine]", "\"\<Thick lens [air]\>\"", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "3"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneThickLensAir"}], ",", 
     "\[IndentingNewLine]", "\"\<Thick lens\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "4"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneThickLens"}], ",", "\[IndentingNewLine]", 
     "\"\<Flat interface (in) [air]\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneFlatInterfaceInAir"}], ",", "\[IndentingNewLine]", 
     "\"\<Flat interface (in)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "2"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneFlatInterfaceIn"}], ",", 
     "\[IndentingNewLine]", "\"\<Flat interface (out) [air]\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneFlatInterfaceOutAir"}], ",", "\[IndentingNewLine]", 
     "\"\<Flat interface (out)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "2"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneFlatInterfaceOut"}], ",", 
     "\[IndentingNewLine]", "\"\<Curved interface (in) [air]\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "2"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneCurvedInterfaceInAir"}], ",", 
     "\[IndentingNewLine]", "\"\<Curved interface (in)\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "3"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneCurvedInterfaceIn"}], ",", 
     "\[IndentingNewLine]", "\"\<Curved interface (out) [air]\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "2"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneCurvedInterfaceOutAir"}], ",", 
     "\[IndentingNewLine]", "\"\<Curved interface (out)\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "3"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "paneCurvedInterfaceOut"}], ",", 
     "\[IndentingNewLine]", "\"\<Flat mirror\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "0"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneFlatMirror"}], ",", "\[IndentingNewLine]", "\"\<Curved mirror\>\"",
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneCurvedMirror"}], ",", "\[IndentingNewLine]", "\"\<Apperture\>\"", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"TrueQ", "[", "input", "]"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "input", "]"}], "\[NotEqual]", "1"}]}], ",", 
        RowBox[{"input", "=", 
         RowBox[{"{", "0", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "paneApperture"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882497222514935`*^9, 3.5882497630828285`*^9}, {
   3.588249865587692*^9, 3.5882498892850475`*^9}, {3.588251388789814*^9, 
   3.5882513937700987`*^9}, {3.5882549811882877`*^9, 
   3.5882549835214205`*^9}, {3.5882550184794207`*^9, 
   3.5882550269979076`*^9}, {3.588255954677968*^9, 3.5882559570691047`*^9}, {
   3.5882574120113225`*^9, 3.5882574339855795`*^9}, {3.58825765131201*^9, 
   3.588257653801152*^9}, {3.588257750363675*^9, 3.588257758256127*^9}, {
   3.5882579805218396`*^9, 3.5882580235713015`*^9}, {3.588258104783947*^9, 
   3.58825811533255*^9}, {3.5886812972329273`*^9, 3.5886812991180353`*^9}, {
   3.5886838757454095`*^9, 3.588683877369502*^9}, {3.588870601814986*^9, 
   3.588870625110319*^9}, {3.5888709104306383`*^9, 3.588870917898065*^9}, 
   3.588871227872795*^9, 3.5888716130488253`*^9, {3.590226388161244*^9, 
   3.5902264042291627`*^9}, {3.59025834583988*^9, 3.590258443256452*^9}, {
   3.590258481636647*^9, 3.5902588202390137`*^9}, {3.5902588735510635`*^9, 
   3.590258937619728*^9}, {3.5912083957856674`*^9, 3.59120839794079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"switchAdd", ":=", "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", "\[IndentingNewLine]", 
    RowBox[{
    "hardware", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Choose\>\"", ",", "\[IndentingNewLine]", "Null", ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Free space\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFreeSpace", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<d\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixFreeSpace", "/.", 
          RowBox[{"d", "\[Rule]", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Slab\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFreeSpace", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<d\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixSlab", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Thin lens\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsThinLens", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<f\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixLens", "/.", 
          RowBox[{"f", "\[Rule]", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Thick lens [air]\>\"",
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsThickLens", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<d\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixThickLensAir", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Thick lens\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsThickLens", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<d\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n1\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n2\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixThickLens", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"d", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n1", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n2", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "4", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Flat interface (in) [air]\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFlatInterface", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<n\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixFlatInterfaceInAir", "/.", 
          RowBox[{"n", "\[Rule]", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Flat interface (in)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFlatInterface", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n1\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n2\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixFlatInterfaceIn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n1", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n2", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Flat interface (out) [air]\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFlatInterface", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<n\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixFlatInterfaceOutAir", "/.", 
          RowBox[{"n", "\[Rule]", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Flat interface (out)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFlatInterface", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n1\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n2\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixFlatInterfaceOut", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n1", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n2", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Curved interface (in) [air]\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsCurvedInterfaceIn", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixCurvedInterfaceInAir", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Curved interface (in)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsCurvedInterfaceIn", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n1\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n2\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixCurvedInterfaceIn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n1", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n2", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Curved interface (out) [air]\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsCurvedInterfaceOut", ",", "positionAdd"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixCurvedInterfaceOutAir", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\"\<Curved interface (out)\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsCurvedInterfaceOut", ",", "positionAdd"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<r\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n1\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<n2\>\"", ",", 
            RowBox[{
            "input", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
            "}"}]}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixCurvedInterfaceOut", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n1", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"n2", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Flat mirror\>\"", ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsFlatMirrorAir", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", "matrixFlatMirror", ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Curved mirror\>\"", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsCurvedMirrorAir", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<r\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixCurvedMirror", "/.", 
          RowBox[{"r", "\[Rule]", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\"\<Apperture\>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"insertAfterGraphics", "[", 
       RowBox[{"graphicsNone", ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"insertAfterParameters", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Sigma]\>\"", ",", 
           RowBox[{
           "input", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "}"}], ",", "positionAdd"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABCDElements", "=", 
       RowBox[{"Insert", "[", 
        RowBox[{"ABCDElements", ",", 
         RowBox[{"matrixApperture", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"k", "\[Rule]", "kin"}], ",", 
            RowBox[{"\[Sigma]", "\[Rule]", 
             RowBox[{
             "input", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "ABCDElements", "]"}], "-", 
          "positionAdd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ABCD", "=", 
       RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882606763040295`*^9, 3.5882606881177053`*^9}, {
   3.5882608372952375`*^9, 3.58826084379661*^9}, {3.588684193551587*^9, 
   3.5886842441374807`*^9}, {3.5886842945243626`*^9, 3.588684308163142*^9}, {
   3.5886843401279707`*^9, 3.588684397387246*^9}, {3.58868460971739*^9, 
   3.588684611441489*^9}, {3.5886860827836447`*^9, 3.5886860850107727`*^9}, {
   3.588686214946204*^9, 3.588686228069955*^9}, {3.588860014204793*^9, 
   3.588860066931809*^9}, {3.5888706408062162`*^9, 3.588870691302105*^9}, {
   3.590258842999316*^9, 3.590258864208529*^9}, {3.590258973789797*^9, 
   3.5902591299627295`*^9}, {3.590259166226804*^9, 3.590259428440801*^9}, {
   3.590259793419677*^9, 3.5902600263840017`*^9}, {3.5907647945813475`*^9, 
   3.59076485232165*^9}, {3.590764962392946*^9, 3.5907649802049646`*^9}, 
   3.5908377975818796`*^9, {3.5908508143733215`*^9, 3.5908508209826994`*^9}, {
   3.5912076356941924`*^9, 3.591207647229852*^9}, {3.5912083461368275`*^9, 
   3.5912083601206274`*^9}, {3.5912147860034227`*^9, 3.591214883986027*^9}}],

Cell[BoxData[
 RowBox[{"deleteABCDElement", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ABCDElements", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"ABCDElements", ",", 
       RowBox[{
        RowBox[{"Length", "[", "ABCDElements", "]"}], "-", "deleteNum"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ABCD", "=", 
     RowBox[{"Dot", "@@", "ABCDElements"}]}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.588340300666977*^9, 3.5883403158198433`*^9}, {
  3.588340358869306*^9, 3.5883403645796328`*^9}, {3.5883404535897236`*^9, 
  3.588340468809594*^9}, {3.588340499979377*^9, 3.5883405132421355`*^9}, {
  3.5883407872598085`*^9, 3.588340788003851*^9}, {3.58834095967667*^9, 
  3.5883409724083986`*^9}, {3.59121553827745*^9, 3.5912155506751595`*^9}, {
  3.5912157964802184`*^9, 3.591215796623227*^9}}],

Cell[BoxData[
 RowBox[{"deleteParameter", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gParameters", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"gParameters", ",", "deleteNum"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"gParameters", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{
       RowBox[{"gParameters", "=", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.588871374139161*^9, 3.588871405871976*^9}, {
  3.588871694336475*^9, 3.588871694493484*^9}, {3.5888719892133408`*^9, 
  3.588872018273003*^9}}],

Cell[BoxData[
 RowBox[{"deleteGraphicsElement", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graphics", "=", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graphics", "\[LeftDoubleBracket]", 
        RowBox[{";;", 
         RowBox[{"deleteNum", "+", "1"}]}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Translate", "[", 
          RowBox[{
           RowBox[{
           "graphics", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"deleteNum", "+", "2"}], ",", 
           RowBox[{"Length", "[", "graphics", "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"graphics", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{"graphics", ",", 
       RowBox[{"deleteNum", "+", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.5883403060552855`*^9, 3.588340312020626*^9}, {
  3.588340471440745*^9, 3.588340526641902*^9}, {3.5883407939891934`*^9, 
  3.5883407947212353`*^9}, {3.588341291948675*^9, 3.588341301428217*^9}, {
  3.5883413384673357`*^9, 3.5883414777743034`*^9}}],

Cell[BoxData[
 RowBox[{"updateAllTime", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"degQ", "\[NotEqual]", "degQBuffer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"degQ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Phi]in", "=", 
           RowBox[{"N", "[", 
            RowBox[{"radToDeg", "[", "\[Phi]in", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Phi]inBuffer", "=", 
           RowBox[{"N", "[", 
            RowBox[{"radToDeg", "[", "\[Phi]inBuffer", "]"}], "]"}]}], ";"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Phi]in", "=", 
           RowBox[{"N", "[", 
            RowBox[{"degToRad", "[", "\[Phi]in", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Phi]inBuffer", "=", 
           RowBox[{"N", "[", 
            RowBox[{"degToRad", "[", "\[Phi]inBuffer", "]"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"degQBuffer", "=", "degQ"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"degQ", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"yin", ">", ".5"}], ",", 
         RowBox[{"yin", "=", ".5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"yin", "<", 
          RowBox[{"-", ".5"}]}], ",", 
         RowBox[{"yin", "=", 
          RowBox[{"-", ".5"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]in", ">", "30"}], ",", 
         RowBox[{"\[Phi]in", "=", "30"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]in", "<", 
          RowBox[{"-", "30"}]}], ",", 
         RowBox[{"\[Phi]in", "=", 
          RowBox[{"-", "30"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"in", "=", 
        RowBox[{"{", 
         RowBox[{"yin", ",", 
          RowBox[{"degToRad", "[", "\[Phi]in", "]"}]}], "}"}]}], ";"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"yin", ">", ".5"}], ",", 
         RowBox[{"yin", "=", ".5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"yin", "<", 
          RowBox[{"-", ".5"}]}], ",", 
         RowBox[{"yin", "=", 
          RowBox[{"-", ".5"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]in", ">", 
          RowBox[{"\[Pi]", "/", "6"}]}], ",", 
         RowBox[{"\[Phi]in", "=", 
          RowBox[{"\[Pi]", "/", "6"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]in", "<", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "6"}]}], ",", 
         RowBox[{"\[Phi]in", "=", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "/", "6"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"in", "=", 
        RowBox[{"{", 
         RowBox[{"yin", ",", "\[Phi]in"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"airQ", "\[NotEqual]", "airQBuffer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hardware", "=."}], ";", "\[IndentingNewLine]", 
       RowBox[{"airQBuffer", "=", "airQ"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.588600879773187*^9, 3.5886009059326835`*^9}, 
   3.588600972250477*^9, {3.5902312042247066`*^9, 3.5902312050407534`*^9}, {
   3.5902533621908317`*^9, 3.5902534042832394`*^9}, {3.5902534580563145`*^9, 
   3.590253530952484*^9}, {3.5902537406724796`*^9, 3.590253829068536*^9}, {
   3.5902539935689445`*^9, 3.5902539961760936`*^9}, {3.590254180167617*^9, 
   3.590254327661053*^9}, 3.590254378440958*^9, {3.5902544463488417`*^9, 
   3.5902544547933245`*^9}, {3.59025457481419*^9, 3.590254586661867*^9}, {
   3.5902554553175516`*^9, 3.590255484329211*^9}, {3.5902628611751423`*^9, 
   3.590262902274493*^9}, {3.590262948848157*^9, 3.5902630061714354`*^9}, {
   3.5911855964126177`*^9, 3.5911856356238604`*^9}, {3.5911865794568443`*^9, 
   3.5911867163836765`*^9}, {3.591186865568209*^9, 3.5911868708715124`*^9}, {
   3.591186924484579*^9, 3.591186924660589*^9}, {3.591187911672043*^9, 
   3.591187916252305*^9}, {3.5911882056688585`*^9, 3.5911882063718987`*^9}, {
   3.5911885012027617`*^9, 3.5911885509196053`*^9}, {3.591188755272294*^9, 
   3.591188755464305*^9}}],

Cell[BoxData[
 RowBox[{"updateSomeTimes", ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "graphics", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
     RowBox[{"graphicsBeamIn", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphics", "\[LeftDoubleBracket]", 
      RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
     RowBox[{"Translate", "[", 
      RowBox[{
       RowBox[{"graphicsBeamOut", "[", "out", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "graphics", "]"}], "-", "1"}], ",", "0"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"out", "=", 
     RowBox[{"outFun", "[", 
      RowBox[{"in", ",", "ABCD"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Omega]s", "=", 
     RowBox[{"{", 
      RowBox[{"\[Omega]in", ",", 
       RowBox[{"\[Omega]out", "[", 
        RowBox[{"\[Omega]in", ",", "ABCD", ",", "kin"}], "]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.588600784148718*^9, 3.588600864682324*^9}, 
   3.5886009737855644`*^9, {3.5886011884648433`*^9, 3.5886011953372364`*^9}, {
   3.5886013688501606`*^9, 3.588601371700324*^9}, {3.5902312099200325`*^9, 
   3.5902312101120434`*^9}, {3.590260819979393*^9, 3.590260821418475*^9}, {
   3.591188208512021*^9, 3.5911882109841623`*^9}, {3.5911884242213593`*^9, 
   3.5911884314127703`*^9}, {3.5911885541487904`*^9, 3.591188554275798*^9}, {
   3.591188748588912*^9, 3.591188748700918*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Buttons", "Subsection",
 CellChangeTimes->{{3.588260615835571*^9, 3.588260619740794*^9}}],

Cell[BoxData[
 RowBox[{"manipulatorYIn", ":=", 
  RowBox[{"Manipulator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", 
     RowBox[{"yinBuffer", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"yinBuffer", "=", "#"}], ")"}], "&"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"yin", "=", 
           RowBox[{"#", "/", "20"}]}], ")"}], "&"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
    RowBox[{"AppearanceElements", "\[Rule]", "\"\<InputField\>\""}], ",", 
    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
    RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5885955405177994`*^9, 3.58859566011764*^9}, {
   3.5885960783635626`*^9, 3.5885960975256586`*^9}, {3.5885962997802267`*^9, 
   3.588596339756513*^9}, {3.5885964005009875`*^9, 3.5885964249063835`*^9}, {
   3.5885974677290297`*^9, 3.588597471220229*^9}, {3.5886004466244125`*^9, 
   3.588600447018435*^9}, {3.5886006128239183`*^9, 3.588600616574133*^9}, {
   3.5902606998955245`*^9, 3.59026071713351*^9}, {3.590260784886386*^9, 
   3.5902607870545096`*^9}, {3.590260948370736*^9, 3.5902609687749033`*^9}, 
   3.590261153619476*^9, {3.590261354182947*^9, 3.5902613599342766`*^9}, {
   3.5902619364592514`*^9, 3.5902619408945055`*^9}, 3.5902622282629423`*^9, {
   3.5902623468247232`*^9, 3.590262361210546*^9}, 3.590262410319355*^9, {
   3.590262446031398*^9, 3.590262460323215*^9}, {3.5902625573797665`*^9, 
   3.5902625731386676`*^9}, 3.590262740407235*^9, {3.5902627855398164`*^9, 
   3.5902627934112663`*^9}, {3.5908359335652637`*^9, 3.590836028732707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"manipulator\[Phi]In", ":=", 
   RowBox[{"Manipulator", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{"\[Phi]inBuffer", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Phi]inBuffer", "=", "#"}], ")"}], "&"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Phi]in", "=", 
            RowBox[{"\[Phi]inBuffer", "=", "#"}]}], ")"}], "&"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{"degQ", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Pi]"}], "/", "6"}], ",", 
         RowBox[{"\[Pi]", "/", "6"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"AppearanceElements", "\[Rule]", "\"\<InputField\>\""}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
     RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.588596762681703*^9, 3.5885967665909266`*^9}, {
   3.5885975356399136`*^9, 3.588597541182231*^9}, {3.588600449797594*^9, 
   3.588600450283622*^9}, {3.588600707766349*^9, 3.588600709621455*^9}, {
   3.5902538596542845`*^9, 3.5902538695668516`*^9}, {3.5902607921027985`*^9, 
   3.590260812293953*^9}, {3.590260977247388*^9, 3.5902609852148438`*^9}, 
   3.590261158839774*^9, {3.5902619521031466`*^9, 3.590261991011372*^9}, 
   3.590262232007156*^9}],

Cell[BoxData[
 RowBox[{"manipulator\[Omega]In", ":=", 
  RowBox[{"Manipulator", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "\[Omega]in", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "10"}], "}"}], ",", 
    RowBox[{"AppearanceElements", "\[Rule]", "\"\<InputField\>\""}], ",", 
    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.591188109552361*^9, 3.591188137003931*^9}, {
  3.591203690080516*^9, 3.5912036914995975`*^9}, {3.591206182493074*^9, 
  3.5912061832681184`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setterDegQ", ":=", "\[IndentingNewLine]", 
   RowBox[{"SetterBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{"degQ", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"degQ", "=", "#"}], ")"}], "&"}], ",", 
         RowBox[{"updateSomeTimes", ";"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"True", "\[Rule]", "\"\<degrees\>\""}], ",", 
       RowBox[{"False", "\[Rule]", "\"\<radians\>\""}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5902635884547405`*^9, 3.590263593310018*^9}, 
   3.590263645930028*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"setterAirQ", ":=", "\[IndentingNewLine]", 
   RowBox[{"SetterBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "airQ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"True", "\[Rule]", "\"\<In air\>\""}], ",", 
       RowBox[{"False", "\[Rule]", "\"\<In other medium\>\""}]}], "}"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.590263648035148*^9, 3.590263653762476*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"menuHardware", ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{"airQ", ",", "\[IndentingNewLine]", 
     RowBox[{"PopupMenu", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dynamic", "[", "hardware", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Choose\>\"", ",", "\[IndentingNewLine]", "\"\<Free space\>\"", 
         ",", "\[IndentingNewLine]", "\"\<Thin lens\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<Thick lens [air]\>\"", "\[Rule]", "\"\<Thick lens\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<Flat interface (in) [air]\>\"", "\[Rule]", 
          "\"\<Flat interface (in)\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<Flat interface (out) [air]\>\"", "\[Rule]", 
          "\"\<Flat interface (out)\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<Curved interface (in) [air]\>\"", "\[Rule]", 
          "\"\<Curved interface (in)\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<Curved interface (out) [air]\>\"", "\[Rule]", 
          "\"\<Curved interface (out)\>\""}], ",", "\[IndentingNewLine]", 
         "\"\<Flat mirror\>\"", ",", "\[IndentingNewLine]", 
         "\"\<Curved mirror\>\"", ",", "\[IndentingNewLine]", 
         "\"\<Apperture\>\""}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PopupMenu", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dynamic", "[", "hardware", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Choose\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Slab\>\"", "\[Rule]", "\"\<Free space\>\""}], ",", 
         "\[IndentingNewLine]", "\"\<Thin lens\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Thick lens\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Flat interface (in)\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Flat interface (out)\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Curved interface (in)\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Curved interface (out)\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Flat mirror\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Curved mirror\>\"", ",", 
         "\[IndentingNewLine]", "\"\<Apperture\>\""}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.588249333060233*^9, 3.588249335260359*^9}, {
   3.588249384713187*^9, 3.588249386211273*^9}, {3.5882494290517235`*^9, 
   3.5882495322586265`*^9}, {3.5882498354219666`*^9, 3.588249848631722*^9}, {
   3.588249987332655*^9, 3.5882499879276896`*^9}, 3.5882500228566875`*^9, {
   3.588257380436517*^9, 3.58825738241463*^9}, {3.5882574385818424`*^9, 
   3.5882574394218903`*^9}, {3.588681280298959*^9, 3.588681283334132*^9}, {
   3.588870724584008*^9, 3.588870726481117*^9}, {3.590255237410088*^9, 
   3.590255266914776*^9}, {3.59025530983023*^9, 3.5902553149985256`*^9}, 
   3.5902553531067057`*^9, {3.5902555696030884`*^9, 3.590255617382821*^9}, {
   3.590263150995719*^9, 3.5902634950183964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"menuPosition", ":=", "\[IndentingNewLine]", 
   RowBox[{"PopupMenu", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "positionAdd", "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "graphics", "]"}], "-", "2"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588684072681674*^9, 3.5886840940718975`*^9}, {
  3.5886841450628138`*^9, 3.588684150621132*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"buttonAdd", ":=", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Add\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
     "switchAdd", ";", "\[IndentingNewLine]", "clearVariablesAdd", ";"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Or", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Equal", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}], ",", "input"}], "]"}]}], 
         "]"}], ",", "False", ",", "True"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882582370205107`*^9, 3.5882582962748995`*^9}, {
  3.5882583278377047`*^9, 3.588258344694669*^9}, {3.5882584341027827`*^9, 
  3.588258436402914*^9}, {3.588258470733878*^9, 3.5882584928941455`*^9}, {
  3.5882585256260176`*^9, 3.588258536980667*^9}, {3.588258667183114*^9, 
  3.5882587082714643`*^9}, {3.5882595850216117`*^9, 3.5882596003804903`*^9}, {
  3.588260024496748*^9, 3.588260042131757*^9}, {3.5882601205872445`*^9, 
  3.588260155613248*^9}, {3.5882606726308193`*^9, 3.588260702071503*^9}, {
  3.5882607421667967`*^9, 3.5882607482961473`*^9}, {3.5882608079355583`*^9, 
  3.5882608097906647`*^9}, {3.588261079102068*^9, 3.5882610863014803`*^9}, {
  3.5888715975949416`*^9, 3.588871597886958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"menuDelete", ":=", "\[IndentingNewLine]", 
   RowBox[{"PopupMenu", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "deleteNum", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Choose\>\"", "}"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Length", "[", "ABCDElements", "]"}], "-", "1"}], "]"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5883403961194363`*^9, 3.5883404144594855`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"buttonDelete", ":=", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Delete\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
     "deleteABCDElement", ";", "\[IndentingNewLine]", "deleteParameter", ";", 
      "\[IndentingNewLine]", "deleteGraphicsElement", ";", 
      "\[IndentingNewLine]", "clearVariablesAdd", ";"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"deleteNum", "\[Equal]", "\"\<Choose\>\""}], ",", "False", 
        ",", "True"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.588339866183126*^9, 3.588339875096636*^9}, 
   3.588339942553494*^9, {3.5883400330046673`*^9, 3.5883400490505857`*^9}, {
   3.5883401550666494`*^9, 3.58834015753279*^9}, {3.588340548720165*^9, 
   3.5883405551345315`*^9}, 3.588595141087953*^9, {3.5888714261701365`*^9, 
   3.588871429602333*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"buttonClearAll", "=", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Clear all\>\"", ",", "clearAll"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"buttonClearElements", "=", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Clear elements\>\"", ",", "clearElements"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"buttonClearInput", "=", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Clear input\>\"", ",", "clearInput"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5882603140283084`*^9, 3.5882603234458475`*^9}, {
   3.5882608146839447`*^9, 3.588260820086253*^9}, 3.59026358058229*^9, {
   3.591178115494734*^9, 3.591178116278778*^9}, {3.5912063003238134`*^9, 
   3.591206348103546*^9}, {3.5912066482677145`*^9, 3.5912066521079345`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Panes", "Subsection",
 CellChangeTimes->{{3.5882604403725348`*^9, 3.5882604527292414`*^9}}],

Cell[CellGroupData[{

Cell["Hardware panes", "Subsubsection",
 CellChangeTimes->{{3.590263693950774*^9, 3.590263705617442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneNone", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", 
    RowBox[{"Null", ",", "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588683427067747*^9, 3.588683496060693*^9}, 
   3.5886835433273964`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFreeSpace", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextFreeSpace", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<d = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882500080898423`*^9, 3.588250053907463*^9}, {
   3.588250109642651*^9, 3.5882501418234916`*^9}, {3.588250196504619*^9, 
   3.588250227724405*^9}, {3.588251202450156*^9, 3.5882512161469393`*^9}, 
   3.5882514498143044`*^9, {3.5882523433814135`*^9, 3.5882523456685443`*^9}, {
   3.588254806335286*^9, 3.5882548083854036`*^9}, {3.5882548501847944`*^9, 
   3.5882548852708015`*^9}, {3.5882549719117565`*^9, 3.5882549764270153`*^9}, 
   3.588257639415329*^9, {3.5882586033924656`*^9, 3.5882586422046857`*^9}, {
   3.5886838110547094`*^9, 3.5886838364331613`*^9}, {3.5908341460670247`*^9, 
   3.5908341508122964`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneSlab", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextSlab", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<d = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588870769080553*^9, 3.588870769647586*^9}, {
   3.588870805023609*^9, 3.588870811101957*^9}, 3.58887114788622*^9, {
   3.5907655377148523`*^9, 3.590765538162878*^9}, {3.59083415980381*^9, 
   3.5908341612428927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneLens", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextThinLensAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<f = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588251351783697*^9, 3.588251369223695*^9}, 
   3.588251443955969*^9, 3.588251504443429*^9, {3.5882523068303227`*^9, 
   3.5882523374540744`*^9}, {3.5882548112905703`*^9, 3.588254813495696*^9}, {
   3.588254893313261*^9, 3.5882549034008384`*^9}, {3.588254966408442*^9, 
   3.5882549703166656`*^9}, 3.5882576419954767`*^9, {3.5882586146861115`*^9, 
   3.588258644392811*^9}, {3.588683501923028*^9, 3.588683537685074*^9}, {
   3.588683627266197*^9, 3.588683634494611*^9}, {3.5886836850145006`*^9, 
   3.5886836866565943`*^9}, {3.5886837264098682`*^9, 3.588683737090479*^9}, 
   3.5886838217243195`*^9, {3.5907650840779057`*^9, 3.590765101777918*^9}, {
   3.590765290398707*^9, 3.5907652909337373`*^9}, 3.5908341664861927`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneThickLens", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextThickLens", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<d = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"RadioButtonBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "rQ", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"True", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=", "#"}], ";", 
                    RowBox[{"fInput", "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"rToF", "[", "#", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n1", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n2", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", "rQ", "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"False", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<f = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"fInput", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fInput", "=", "#"}], ";", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"fToR", "[", "#", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n1", "\[Rule]", 
                    RowBox[{"input", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n2", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"!", "rQ"}], "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "Center"}], "]"}], ",", "\[IndentingNewLine]", "sizeHardware"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638001838503`*^9, 3.590263807293257*^9}, {
  3.590323606597247*^9, 3.590323666276661*^9}, {3.590324159563875*^9, 
  3.5903242785536814`*^9}, {3.590324599729051*^9, 3.5903246689150085`*^9}, {
  3.590324706971185*^9, 3.5903247517017436`*^9}, {3.5903247917870364`*^9, 
  3.5903248049747906`*^9}, {3.5903250128716817`*^9, 3.5903250348239374`*^9}, {
  3.5903250715240364`*^9, 3.5903250944523478`*^9}, {3.590325622953576*^9, 
  3.5903256599336915`*^9}, {3.5907651084823017`*^9, 3.5907651111704555`*^9}, {
  3.590831930873323*^9, 3.590831937393696*^9}, {3.5908340579789867`*^9, 
  3.590834084125482*^9}, {3.590834170909446*^9, 3.5908341830221386`*^9}, {
  3.590834451265481*^9, 3.590834456506781*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneThickLensAir", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextThickLensAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<d = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"RadioButtonBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "rQ", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"True", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=", "#"}], ";", 
                    RowBox[{"fInput", "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"rToF", "[", "#", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n1", "\[Rule]", "1"}], ",", 
                    RowBox[{"n2", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", "rQ", "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"False", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<f = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"fInput", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fInput", "=", "#"}], ";", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"fToR", "[", "#", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"n1", "\[Rule]", "1"}], ",", 
                    RowBox[{"n2", "\[Rule]", 
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"!", "rQ"}], "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "Center"}], "]"}], ",", "\[IndentingNewLine]", "sizeHardware"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638090463576`*^9, 3.590263815069702*^9}, {
   3.5903257134887547`*^9, 3.5903257838417788`*^9}, {3.5907651250702505`*^9, 
   3.5907651267893486`*^9}, {3.590831758943489*^9, 3.590831766791938*^9}, 
   3.590834047571391*^9, {3.590834189765524*^9, 3.590834193237723*^9}, {
   3.5908344393447995`*^9, 3.590834443673047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFlatInterfaceIn", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextFlatInterfaceIn", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263817063816*^9, 3.5902638251412783`*^9}, {
  3.590325820216859*^9, 3.5903258577750072`*^9}, {3.590765135522848*^9, 
  3.59076513869703*^9}, {3.59083419739196*^9, 3.59083419843102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFlatInterfaceInAir", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextFlatInterfaceInAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263826815374*^9, 3.590263832045673*^9}, {
   3.5903258749009867`*^9, 3.5903258851585736`*^9}, {3.5907651448423815`*^9, 
   3.590765146513477*^9}, 3.5908342023422437`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFlatInterfaceOut", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextFlatInterfaceOut", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263833238741*^9, 3.5902638381100197`*^9}, {
  3.590325893033024*^9, 3.5903258949271326`*^9}, {3.5907651496356554`*^9, 
  3.590765151690773*^9}, {3.590834205183406*^9, 3.590834206783498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFlatInterfaceOutAir", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextFlatInterfaceOutAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638392550855`*^9, 3.590263845325433*^9}, {
   3.590325926896961*^9, 3.5903259362424955`*^9}, {3.5907651575941105`*^9, 
   3.5907651589781895`*^9}, 3.5908342095506563`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneCurvedInterfaceIn", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextCurvedInterfaceIn", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263846527501*^9, 3.5902638526178493`*^9}, {
  3.590325949517255*^9, 3.5903259728635902`*^9}, {3.59076516369946*^9, 
  3.5907651756881456`*^9}, {3.5908342125688286`*^9, 3.5908342148599596`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneCurvedInterfaceInAir", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextCurvedInterfaceInAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638598192616`*^9, 3.590263865361579*^9}, {
  3.5903259908606195`*^9, 3.590326001219212*^9}, {3.590765182175517*^9, 
  3.5907651842066326`*^9}, {3.590834217035084*^9, 3.590834218315157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneCurvedInterfaceOut", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextCurvedInterfaceOut", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(1\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\) = \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263866875665*^9, 3.590263872537989*^9}, {
  3.5903260081376076`*^9, 3.590326009363678*^9}, {3.5907651875438237`*^9, 
  3.590765189670945*^9}, {3.5908342208283005`*^9, 3.5908342236844645`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneCurvedInterfaceOutAir", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsTextCurvedInterfaceOutAir", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<n = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638741240797`*^9, 3.590263878809348*^9}, {
  3.5903260212813597`*^9, 3.590326027827734*^9}, {3.5907651947992387`*^9, 
  3.5907651962453213`*^9}, {3.590834226003597*^9, 3.5908342269716525`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneFlatMirror", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"graphicsFlatMirrorAir", ",", 
          RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], 
        "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], ",", 
     "\[IndentingNewLine]", "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590263881772517*^9, 3.59026388951396*^9}, {
  3.590326084444972*^9, 3.5903261019299726`*^9}, {3.5912075703724566`*^9, 
  3.5912075721605587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneCurvedMirror", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsCurvedMirrorAirText", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RadioButtonBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "rQ", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"True", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<r = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "=", "#"}], ";", 
                    RowBox[{"fInput", "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"rToFMirror", "[", "#", "]"}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", "rQ", "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"False", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<f = \>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"fInput", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fInput", "=", "#"}], ";", 
                    RowBox[{
                    RowBox[{
                    "input", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"fToRMirror", "[", "#", "]"}], "]"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}]}]}], ")"}], "&"}]}], "]"}], 
                   ",", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"sizeInputFieldHardware", ",", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"!", "rQ"}], "]"}]}], ",", 
                   RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}],
                 "\[IndentingNewLine]", "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "Center"}], "]"}], ",", "\[IndentingNewLine]", "sizeHardware"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902638908520365`*^9, 3.5902638979254413`*^9}, {
   3.5903260363292203`*^9, 3.5903260455427475`*^9}, 3.5908342298268156`*^9, {
   3.5912075799050016`*^9, 3.5912075839662333`*^9}, {3.591207935100318*^9, 
   3.5912080122147284`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneApperture", ":=", "\[IndentingNewLine]", 
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"graphicsNone", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<\[Sigma] = \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
               "input", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], ",", "Number", ",", 
              RowBox[{"FieldSize", "\[Rule]", "sizeInputFieldHardware"}], ",", 
              RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
     "sizeHardware"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5902639008326073`*^9, 3.5902639044138126`*^9}, {
  3.5903260557893333`*^9, 3.5903260760074897`*^9}, {3.5908342315639153`*^9, 
  3.5908342324269643`*^9}, {3.5912083167111444`*^9, 3.5912083199333286`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elements panes", "Subsubsection",
 CellChangeTimes->{{3.5902637346010995`*^9, 3.590263739769395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneYIn", ":=", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(y\), \(in\)]\) [mm]\>\"", ",", 
       "\[IndentingNewLine]", "manipulatorYIn"}], "\[IndentingNewLine]", 
      "}"}], ",", "Center"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588596440774291*^9, 3.5885965025368233`*^9}, 
   3.588596661207899*^9, {3.5888585437766895`*^9, 3.5888585928864985`*^9}, {
   3.5908359021934695`*^9, 3.5908359023364773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pane\[Phi]In", ":=", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Phi]\), \(in\)]\) [\>\"", "<>", 
        RowBox[{"If", "[", 
         RowBox[{"degQ", ",", "\"\<deg\>\"", ",", "\"\<rad\>\""}], "]"}], 
        "<>", "\"\<]\>\""}], ",", "\[IndentingNewLine]", 
       "manipulator\[Phi]In"}], "\[IndentingNewLine]", "}"}], ",", "Center"}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588596512170375*^9, 3.588596521277896*^9}, 
   3.5885966596438093`*^9, {3.5888585970337353`*^9, 3.5888586004619317`*^9}, {
   3.590231648131097*^9, 3.59023167405558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pane\[Lambda]In", ":=", "\[IndentingNewLine]", 
   RowBox[{"RadioButtonBar", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", "\[Lambda]Q", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"True", "\[Rule]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"\"\<\[Lambda] [nm] \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"\[Lambda]inBuffer", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Lambda]inBuffer", "=", "#"}], ")"}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Lambda]in", "=", 
                    RowBox[{"#", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}]}], ";", 
                    RowBox[{"kin", "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"\[Lambda]tok", "[", "\[Lambda]in", "]"}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"kinBuffer", "=", 
                    RowBox[{"kin", "*", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}]}]}], ")"}], "&"}]}], 
                "}"}]}], "]"}], ",", "Number", ",", 
             RowBox[{"FieldSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"sizeInputFieldIn", ",", "1"}], "}"}]}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"Dynamic", "[", "\[Lambda]Q", "]"}]}], ",", 
             RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"False", "\[Rule]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<k [\!\(\*SuperscriptBox[\(nm\), \(-1\)]\)] \>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"kinBuffer", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"kinBuffer", "=", "#"}], ")"}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"kin", "=", 
                    RowBox[{"#", "*", 
                    RowBox[{"10", "^", "6"}]}]}], ";", 
                    RowBox[{"\[Lambda]in", "=", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"kto\[Lambda]", "[", "kin", "]"}], "]"}], "]"}]}],
                     ";", 
                    RowBox[{"\[Lambda]inBuffer", "=", 
                    RowBox[{"\[Lambda]in", "*", 
                    RowBox[{"10", "^", "6"}]}]}]}], ")"}], "&"}]}], "}"}]}], 
              "]"}], ",", "Number", ",", 
             RowBox[{"FieldSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"sizeInputFieldIn", ",", "1"}], "}"}]}], ",", 
             RowBox[{"Enabled", "\[Rule]", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"!", "\[Lambda]Q"}], "]"}]}], ",", 
             RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Horizontal\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59117820266772*^9, 3.5911782772339845`*^9}, {
   3.5911783437997923`*^9, 3.5911784626025867`*^9}, {3.5911785051600213`*^9, 
   3.59117851911782*^9}, {3.5911785734269257`*^9, 3.5911786076478834`*^9}, {
   3.59117864150782*^9, 3.591178665162173*^9}, {3.5911787269857087`*^9, 
   3.5911788115245442`*^9}, {3.591178871001946*^9, 3.5911788717949915`*^9}, {
   3.591178910804223*^9, 3.591178981543269*^9}, {3.5911790310771017`*^9, 
   3.5911790414466953`*^9}, 3.59117910762148*^9, {3.5911871698406124`*^9, 
   3.5911871721347437`*^9}, {3.5911880174440928`*^9, 3.591188036664192*^9}, {
   3.591205454564439*^9, 3.5912054582766514`*^9}, {3.5912117161055784`*^9, 
   3.591211806032722*^9}, {3.591211837881544*^9, 3.591211876156733*^9}, {
   3.591212069157772*^9, 3.5912120705098495`*^9}, {3.591212121489765*^9, 
   3.5912121236088867`*^9}, {3.5912121684204493`*^9, 3.591212208248728*^9}, {
   3.5912125033608627`*^9, 3.5912125180407023`*^9}, {3.59121264264983*^9, 
   3.5912126753086977`*^9}, {3.591212713056857*^9, 3.5912127375472574`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pane\[Omega]In", ":=", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(in\)]\) [mm]\>\"", ",", 
       "\[IndentingNewLine]", "manipulator\[Omega]In"}], 
      "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5911822092778845`*^9, 3.5911823018231783`*^9}, {
   3.591183322457555*^9, 3.591183329620964*^9}, {3.591183391634512*^9, 
   3.591183410472589*^9}, {3.5911834418653846`*^9, 3.5911834852018633`*^9}, {
   3.5911842633603716`*^9, 3.591184268147645*^9}, {3.5911844583015213`*^9, 
   3.5911844939175587`*^9}, {3.5911845347758956`*^9, 
   3.5911845359139605`*^9}, {3.591184704399597*^9, 3.591184704883625*^9}, {
   3.5911848398193426`*^9, 3.591184840328372*^9}, {3.5911850145643377`*^9, 
   3.5911850319553328`*^9}, {3.5911850641321726`*^9, 3.591185064920218*^9}, {
   3.591185105970566*^9, 3.5911851346542063`*^9}, 3.5911852199550858`*^9, {
   3.591186534171254*^9, 3.591186541719686*^9}, {3.591187939644643*^9, 
   3.591187941235734*^9}, {3.591188041476467*^9, 3.5911880420194983`*^9}, {
   3.591188077248513*^9, 3.5911880836408787`*^9}, {3.591188150731716*^9, 
   3.591188156283034*^9}, {3.5912062055233912`*^9, 3.5912062056673994`*^9}}],

Cell[BoxData[
 RowBox[{"paneDegQ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Row", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Unit of angles: \>\"", ",", "\[IndentingNewLine]", "setterDegQ"}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5902315435541153`*^9, 3.590231608423826*^9}, {
   3.590253293215886*^9, 3.5902532936899137`*^9}, {3.590262674770481*^9, 
   3.590262719199022*^9}, {3.590263567223526*^9, 3.590263570461711*^9}, 
   3.59026363949866*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneIn", ":=", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "paneDegQ", ",", "\[IndentingNewLine]", "paneYIn", ",", 
       "\[IndentingNewLine]", "pane\[Phi]In", ",", "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", "pane\[Lambda]In", ",", "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", "pane\[Omega]In"}], "\[IndentingNewLine]", 
      "}"}], ",", "Center"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5885966497982464`*^9, 3.588596655400567*^9}, {
  3.5885968205090103`*^9, 3.588596893129164*^9}, {3.5902314245953116`*^9, 
  3.5902314301916313`*^9}, {3.590231478696406*^9, 3.590231568163523*^9}, {
  3.5911780501189947`*^9, 3.5911780531141653`*^9}, {3.591179118023075*^9, 
  3.5911791240004168`*^9}, {3.591185047523223*^9, 3.5911850529205313`*^9}, {
  3.591185163675866*^9, 3.591185166691039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneAirQ", ":=", "\[IndentingNewLine]", "setterAirQ"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.590255165513976*^9, 3.590255166186014*^9}, {
  3.5902636147142425`*^9, 3.590263629562092*^9}}],

Cell[BoxData[
 RowBox[{"paneAdd", ":=", "\[IndentingNewLine]", 
  RowBox[{"Panel", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pane", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Pane", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "paneAirQ", ",", "\[IndentingNewLine]", "menuHardware", ",", 
               "\[IndentingNewLine]", "\"\<After position\>\"", ",", 
               "\[IndentingNewLine]", "menuPosition", ",", 
               "\[IndentingNewLine]", "buttonAdd"}], "\[IndentingNewLine]", 
              "}"}], "]"}], ",", "\[IndentingNewLine]", "sizePaneAdd1"}], 
           "]"}], ",", "\[IndentingNewLine]", "switchHardware"}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Spacer", "[", "5", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "sizePaneAddMain", ",", "\[IndentingNewLine]", 
      RowBox[{"Alignment", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Center", ",", "Center"}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Add element:\>\"", ",", "\[IndentingNewLine]",
     "Top", ",", "\[IndentingNewLine]", 
    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.588339992611357*^9, 3.588339996170561*^9}, {
  3.5886840387427325`*^9, 3.588684062195074*^9}, {3.5886862926916513`*^9, 
  3.5886862934696956`*^9}, {3.588872211866076*^9, 3.5888722392906446`*^9}, {
  3.5902551046464944`*^9, 3.590255105774559*^9}, {3.590255139746502*^9, 
  3.5902551432347016`*^9}, {3.5903274138950124`*^9, 3.5903274444597607`*^9}, {
  3.5903274752435217`*^9, 3.590327476338584*^9}, {3.5903278840749054`*^9, 
  3.5903279002058277`*^9}, {3.5903281644989443`*^9, 3.5903282356420135`*^9}, {
  3.5903282674748344`*^9, 3.5903282678788576`*^9}, {3.5903284601948576`*^9, 
  3.590328464231088*^9}, {3.5903285043753843`*^9, 3.590328526190632*^9}, {
  3.590776639803856*^9, 3.590776652346573*^9}, {3.5907768673668714`*^9, 
  3.590776889423133*^9}, {3.590777452071315*^9, 3.5907774612868414`*^9}, {
  3.5907776027959356`*^9, 3.59077763591883*^9}}],

Cell[BoxData[
 RowBox[{"paneDelete", ":=", "\[IndentingNewLine]", 
  RowBox[{"Panel", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pane", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<Element number \>\"", ",", "\[IndentingNewLine]", 
             "menuDelete"}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
          "\[IndentingNewLine]", "buttonDelete"}], "\[IndentingNewLine]", 
         "}"}], ",", "Center"}], "]"}], ",", "\[IndentingNewLine]", 
      "sizePaneDelete", ",", "\[IndentingNewLine]", 
      RowBox[{"Alignment", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Center", ",", "Center"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", "\"\<Delete element:\>\"", ",", 
    "\[IndentingNewLine]", "Top", ",", "\[IndentingNewLine]", 
    RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.588339485431348*^9, 3.5883395444317226`*^9}, {
   3.5883395747744584`*^9, 3.58833959455759*^9}, {3.588339651850867*^9, 
   3.588339662531478*^9}, 3.5883397063579845`*^9, {3.588339740750952*^9, 
   3.5883397876356335`*^9}, {3.588339855463513*^9, 3.5883398621588955`*^9}, {
   3.588340021615016*^9, 3.5883400245181823`*^9}, {3.5883403857838454`*^9, 
   3.588340387880965*^9}, {3.5888721275872555`*^9, 3.58887212801528*^9}, {
   3.588872173186864*^9, 3.588872191710923*^9}, {3.588872245422995*^9, 
   3.5888722458690205`*^9}, {3.59032789517854*^9, 3.5903278954575562`*^9}, {
   3.590328383818489*^9, 3.59032843035015*^9}, {3.5903284722505465`*^9, 
   3.590328578530626*^9}, {3.590776795454758*^9, 3.590776814994876*^9}, {
   3.590776845714633*^9, 3.5907768520219936`*^9}, {3.5907772272114534`*^9, 
   3.5907772829806433`*^9}, {3.5907773564318447`*^9, 3.590777371726719*^9}, {
   3.5907774196344595`*^9, 3.590777428602972*^9}, {3.5912038785002933`*^9, 
   3.591203908784025*^9}, {3.5912042041509194`*^9, 3.5912042478924212`*^9}, {
   3.5912043004164257`*^9, 3.5912043153972826`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paneVisualisation", ":=", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pane", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
            "graphics", ",", "\[IndentingNewLine]", "graphicsNumbers", ",", 
             "\[IndentingNewLine]", "graphicsParameters", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "graphicsElementNumberText", "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "sizeVisualisation"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Scrollbars", "\[Rule]", "False"}], ",", 
         RowBox[{"AppearanceElements", "\[Rule]", "None"}], ",", 
         RowBox[{"Alignment", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Center", ",", "Center"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<ABCD matrix\>\"", "<>", "\"\< = \>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ComplexExpand", "[", "ABCD", "]"}], "//", 
           "MatrixForm"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<\!\(\*SubscriptBox[\(y\), \(out\)]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TraditionalForm", "[", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{
                  "out", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "*", "20"}], "]"}], "]"}], 
               "]"}], "<>", 
              "\"\< mm, \!\(\*SubscriptBox[\(\[Phi]\), \(out\)]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TraditionalForm", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"If", "[", 
                  RowBox[{"degQ", ",", 
                   RowBox[{"radToDeg", "[", 
                    RowBox[{
                    "out", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                   RowBox[{
                   "out", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], "]"}], "]"}], "]"}], "<>", 
              RowBox[{"If", "[", 
               RowBox[{"degQ", ",", "\"\< deg\>\"", ",", "\"\< rad\>\""}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(\[Omega]\), \(out\)]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TraditionalForm", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"\[Omega]out", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Omega]s", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "ABCD", ",", "kin"}], 
                  "]"}], "]"}], "]"}], "]"}], "<>", "\"\< mm\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Radius = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TraditionalForm", "[", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"Check", "[", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{"Rout", "[", 
                    RowBox[{"\[Omega]s", ",", "ABCD", ",", "kin"}], "]"}], 
                    "]"}], ",", "\[Infinity]"}], "]"}], "]"}], "]"}], "]"}], 
              "<>", "\"\< ???\>\"", "<>", "\"\<, Phase shift = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TraditionalForm", "[", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"Check", "[", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{"degQ", ",", 
                    RowBox[{"radToDeg", "[", 
                    RowBox[{"\[Delta]out", "[", 
                    RowBox[{
                    RowBox[{
                    "\[Omega]s", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "ABCD", ",", "kin"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"\[Delta]out", "[", 
                    RowBox[{
                    RowBox[{
                    "\[Omega]s", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "ABCD", ",", "kin"}], 
                    "]"}]}], "]"}], "]"}], ",", "\[Infinity]"}], "]"}], "]"}],
                 "]"}], "]"}], "<>", 
              RowBox[{"If", "[", 
               RowBox[{"degQ", ",", "\"\< deg\>\"", ",", "\"\< rad\>\""}], 
               "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "Center"}], 
          "]"}], "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]",
       "}"}], ",", "Center"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5882520881008124`*^9, 3.58825215240249*^9}, {
   3.5882522214524393`*^9, 3.588252258366551*^9}, {3.588252365942704*^9, 
   3.5882523726100855`*^9}, {3.5882545488015566`*^9, 3.588254586310702*^9}, {
   3.588258725223434*^9, 3.588258729901702*^9}, 3.588260892660404*^9, {
   3.5885965616462045`*^9, 3.5885965645653715`*^9}, {3.5886858025476165`*^9, 
   3.5886858279460692`*^9}, {3.5886858706145096`*^9, 
   3.5886859287558355`*^9}, {3.5888567802108192`*^9, 3.5888568117306223`*^9}, 
   3.588856992091938*^9, {3.588857029990106*^9, 3.5888570392996387`*^9}, {
   3.588857116815072*^9, 3.5888571543042164`*^9}, {3.588857281158472*^9, 
   3.5888572816044974`*^9}, {3.5888573490753565`*^9, 
   3.5888573560127535`*^9}, {3.588857445100849*^9, 3.5888574597666874`*^9}, {
   3.588857515190858*^9, 3.5888575422534056`*^9}, {3.588857792326709*^9, 
   3.588857795559894*^9}, {3.588858355219905*^9, 3.588858374829026*^9}, {
   3.5888587647543287`*^9, 3.5888587742218704`*^9}, {3.588859986548211*^9, 
   3.588859986956235*^9}, {3.58886070702142*^9, 3.588860750616914*^9}, {
   3.5888608028699026`*^9, 3.5888608034549356`*^9}, {3.5888608989153957`*^9, 
   3.588860946565121*^9}, {3.588860982440173*^9, 3.588860985839368*^9}, 
   3.5888611334728117`*^9, {3.5888613369714513`*^9, 3.5888613447008934`*^9}, {
   3.590230979321843*^9, 3.5902310654127674`*^9}, {3.5902311577590494`*^9, 
   3.5902311699817486`*^9}, {3.5902313566704264`*^9, 3.59023135900556*^9}, {
   3.5902533092448034`*^9, 3.5902533193323803`*^9}, {3.5902535855646076`*^9, 
   3.5902536391456723`*^9}, {3.5902621253620567`*^9, 
   3.5902621266101274`*^9}, {3.590765912333279*^9, 3.590765915420456*^9}, {
   3.5907660559114914`*^9, 3.5907660593206863`*^9}, {3.590777700831543*^9, 
   3.5907777015375834`*^9}, {3.590777747475211*^9, 3.590777749293315*^9}, {
   3.5907777953179474`*^9, 3.5907778101277943`*^9}, {3.590777855491389*^9, 
   3.5907778562424316`*^9}, {3.5907780341236057`*^9, 3.590778078697156*^9}, {
   3.5907781135591497`*^9, 3.5907781222906485`*^9}, {3.590778156154586*^9, 
   3.590778162664958*^9}, {3.5908358820213156`*^9, 3.590835885868536*^9}, {
   3.590836082260769*^9, 3.5908360922293386`*^9}, {3.5911852442964773`*^9, 
   3.59118527843343*^9}, {3.5911853167476215`*^9, 3.5911853186497307`*^9}, {
   3.5911853612161655`*^9, 3.5911854645090733`*^9}, {3.591185540089396*^9, 
   3.591185567292952*^9}, {3.591185652737839*^9, 3.5911857727857056`*^9}, {
   3.5911858859431777`*^9, 3.5911858922955413`*^9}, {3.59118602637121*^9, 
   3.5911860767230897`*^9}, {3.591186340170158*^9, 3.5911863457784786`*^9}, {
   3.5911864084750648`*^9, 3.591186410098158*^9}, {3.5911865148031464`*^9, 
   3.591186519474414*^9}, {3.591187958930746*^9, 3.5911879627299633`*^9}, {
   3.591188392278532*^9, 3.591188408535462*^9}, {3.5911885859346085`*^9, 
   3.591188595846175*^9}, {3.591188771894245*^9, 3.5911887823668437`*^9}, {
   3.5912055093555727`*^9, 3.591205614571591*^9}, {3.5912062135268493`*^9, 
   3.591206213682858*^9}, {3.5912103458912067`*^9, 3.591210349602419*^9}, {
   3.591210674619009*^9, 3.591210676896139*^9}, {3.5912112831758165`*^9, 
   3.591211306575155*^9}, {3.5912130887393446`*^9, 3.5912131176910005`*^9}, {
   3.5912131486557713`*^9, 3.5912131633356113`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main", "Subsection",
 CellChangeTimes->{{3.588260874248351*^9, 3.5882608792796392`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"main", "=", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Panel", "[", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
       RowBox[{"updateAllTime", ";", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                  "paneAdd", ",", "\[IndentingNewLine]", "paneDelete", ",", 
                   "\[IndentingNewLine]", "buttonClearElements"}], 
                  "\[IndentingNewLine]", "}"}], ",", "Center", ",", "0", ",", 
                 RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Panel", "[", "\[IndentingNewLine]", 
                RowBox[{
                "paneVisualisation", ",", "\[IndentingNewLine]", 
                 "\"\<Visualization\>\"", ",", "\[IndentingNewLine]", "Top", 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", "335"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Panel", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "paneIn", ",", "\[IndentingNewLine]", "\"\<Input\>\"", 
                    ",", "\[IndentingNewLine]", "Top", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "310"}], "}"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                   "buttonClearInput"}], "\[IndentingNewLine]", "}"}], ",", 
                 "Center", ",", "0", ",", 
                 RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}]}], "]"}]}],
               "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Spacer", "[", "5", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "buttonClearAll"}], "\[IndentingNewLine]", 
          "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"unnecessarycontrol", ",", "0", ",", "1", ",", 
       RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
     RowBox[{"Deployed", "\[Rule]", "True"}], ",", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
     RowBox[{"AppearanceElements", "\[Rule]", "\"\<None\>\""}], ",", 
     RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
     RowBox[{"Paneled", "\[Rule]", "False"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.588249097129739*^9, 3.588249158282236*^9}, {
   3.5882492124743357`*^9, 3.58824922111683*^9}, {3.588249776422592*^9, 
   3.5882498027890997`*^9}, {3.5882498544200535`*^9, 3.5882498834347124`*^9}, 
   3.5882499152705336`*^9, {3.58824999318499*^9, 3.588249993497008*^9}, {
   3.588251692847205*^9, 3.588251706691997*^9}, {3.588252077172187*^9, 
   3.5882520832445345`*^9}, {3.588252374705205*^9, 3.5882524616591787`*^9}, {
   3.588252551491317*^9, 3.5882525598257933`*^9}, {3.588254512202463*^9, 
   3.588254533780697*^9}, {3.5882547038834267`*^9, 3.5882547592065907`*^9}, {
   3.588255067147204*^9, 3.5882551020882025`*^9}, 3.5882559464664984`*^9, 
   3.5882560673684134`*^9, {3.58825830100517*^9, 3.5882583023842487`*^9}, {
   3.588260303985734*^9, 3.588260310180088*^9}, 3.588260885171976*^9, {
   3.588339197911903*^9, 3.5883392024831643`*^9}, {3.5883392713071012`*^9, 
   3.5883392800656023`*^9}, {3.5883399789805775`*^9, 
   3.5883399809126883`*^9}, {3.588340074710053*^9, 3.588340086475726*^9}, {
   3.5883402478909583`*^9, 3.5883402489140167`*^9}, {3.5885965709317355`*^9, 
   3.5885966421048064`*^9}, {3.5885968787293406`*^9, 
   3.5885968795623884`*^9}, {3.588596912410267*^9, 3.5885969510804787`*^9}, {
   3.588596984967417*^9, 3.5885969863584967`*^9}, {3.588597072971451*^9, 
   3.5885970939526505`*^9}, {3.5885971827487297`*^9, 3.588597205170012*^9}, {
   3.5885972376528697`*^9, 3.5885972972532787`*^9}, {3.5886003839678288`*^9, 
   3.5886004307955074`*^9}, {3.588600470461776*^9, 3.58860051599938*^9}, {
   3.5886006249256105`*^9, 3.5886006339921293`*^9}, {3.5886007161608295`*^9, 
   3.5886007227772074`*^9}, 3.5886008244420223`*^9, {3.588600869420595*^9, 
   3.588600915266217*^9}, {3.5886863575083585`*^9, 3.588686419320894*^9}, {
   3.5886864512347193`*^9, 3.5886864767861805`*^9}, {3.5902608389074755`*^9, 
   3.5902608422156644`*^9}, {3.5902610108283086`*^9, 3.590261039360941*^9}, {
   3.5902624780292273`*^9, 3.5902624901169195`*^9}, {3.5902627565341573`*^9, 
   3.590262756699167*^9}, {3.590263062975685*^9, 3.5902630631106925`*^9}, 
   3.590327448905015*^9, {3.5903276575319476`*^9, 3.590327671434743*^9}, {
   3.590327805075387*^9, 3.5903278575403876`*^9}, {3.5903279371749425`*^9, 
   3.5903279923470984`*^9}, {3.590328072332673*^9, 3.5903281142320695`*^9}, {
   3.5903281765256324`*^9, 3.5903281809898877`*^9}, {3.5903283738429184`*^9, 
   3.590328375982041*^9}, {3.590776356785668*^9, 3.5907764307088957`*^9}, {
   3.590776946448395*^9, 3.590776953096775*^9}, {3.590776989948883*^9, 
   3.5907770609279423`*^9}, {3.590777118002207*^9, 3.5907771460858135`*^9}, {
   3.5911778635973263`*^9, 3.5911779170803847`*^9}, {3.5911779709174643`*^9, 
   3.591178026202626*^9}, {3.591178068071021*^9, 3.5911780798786964`*^9}, {
   3.5912037464997435`*^9, 3.5912037495129156`*^9}, {3.591203787132067*^9, 
   3.591203853290851*^9}, {3.5912039208197136`*^9, 3.5912039398007994`*^9}, {
   3.591203973603733*^9, 3.59120401900233*^9}, {3.591204071185314*^9, 
   3.5912040865141907`*^9}, {3.5912041426604023`*^9, 
   3.5912041842197795`*^9}, {3.5912042579319954`*^9, 
   3.5912042840194874`*^9}, {3.5912051681750584`*^9, 3.591205190253321*^9}, {
   3.5912065587805967`*^9, 3.591206565031954*^9}, {3.591206608541443*^9, 
   3.591206628179566*^9}, {3.59120667685635*^9, 3.5912067026528254`*^9}, {
   3.5912108445517282`*^9, 3.5912108448997483`*^9}, {3.591216606446546*^9, 
   3.5912166754324913`*^9}, {3.5912172410848455`*^9, 
   3.5912173229415274`*^9}, {3.591217401158001*^9, 3.5912174472946396`*^9}, {
   3.591217535204668*^9, 3.5912175599580836`*^9}, {3.5912176528443966`*^9, 
   3.591217657579667*^9}, {3.5912177079865503`*^9, 3.591217753121132*^9}, {
   3.5913081363170233`*^9, 3.5913081542310476`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.591308161245449*^9, 3.5913081656597013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["main"], "Input",
 CellChangeTimes->{{3.5913081680148363`*^9, 3.591308168393858*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`unnecessarycontrol$$ = 0, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`unnecessarycontrol$$], 0, 1}}, Typeset`size$$ = {
    1060., {219., 227.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`unnecessarycontrol$663202$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`unnecessarycontrol$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`unnecessarycontrol$$, \
$CellContext`unnecessarycontrol$663202$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Panel[
        Dynamic[$CellContext`updateAllTime; Column[{
            Row[{
              
              Column[{$CellContext`paneAdd, $CellContext`paneDelete, \
$CellContext`buttonClearElements}, Center, 0, BaselinePosition -> Bottom], 
              
              Panel[$CellContext`paneVisualisation, "Visualization", Top, 
               FrameMargins -> 0, ImageSize -> {Automatic, 335}, 
               BaselinePosition -> Bottom], 
              Column[{
                
                Panel[$CellContext`paneIn, "Input", Top, FrameMargins -> 0, 
                 ImageSize -> {
                  Automatic, 310}], $CellContext`buttonClearInput}, Center, 0,
                BaselinePosition -> Bottom]}, 
             Spacer[5]], $CellContext`buttonClearAll}]]], 
      "Specifications" :> {{$CellContext`unnecessarycontrol$$, 0, 1, 
         ControlType -> None}}, 
      "Options" :> {
       Deployed -> True, AppearanceElements -> "None", FrameMargins -> 0, 
        Paneled -> False}, "DefaultOptions" :> {}],
     ImageSizeCache->{1060., {221., 226.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`updateAllTime := (
        If[$CellContext`degQ != $CellContext`degQBuffer, 
          If[$CellContext`degQ, $CellContext`\[Phi]in = N[
               $CellContext`radToDeg[$CellContext`\[Phi]in]]; $CellContext`\
\[Phi]inBuffer = N[
               $CellContext`radToDeg[$CellContext`\[Phi]inBuffer]]; 
            Null, $CellContext`\[Phi]in = N[
               $CellContext`degToRad[$CellContext`\[Phi]in]]; $CellContext`\
\[Phi]inBuffer = N[
               $CellContext`degToRad[$CellContext`\[Phi]inBuffer]]; 
            Null]; $CellContext`degQBuffer = $CellContext`degQ; Null]; 
        If[$CellContext`degQ, 
          Which[$CellContext`yin > 0.5, $CellContext`yin = 
            0.5, $CellContext`yin < -0.5, $CellContext`yin = -0.5, \
$CellContext`\[Phi]in > 30, $CellContext`\[Phi]in = 
            30, $CellContext`\[Phi]in < -30, $CellContext`\[Phi]in = -30]; \
$CellContext`in = {$CellContext`yin, 
             $CellContext`degToRad[$CellContext`\[Phi]in]}; Null, 
          Which[$CellContext`yin > 0.5, $CellContext`yin = 
            0.5, $CellContext`yin < -0.5, $CellContext`yin = -0.5, \
$CellContext`\[Phi]in > Pi/6, $CellContext`\[Phi]in = 
            Pi/6, $CellContext`\[Phi]in < -Pi/6, $CellContext`\[Phi]in = -Pi/
             6]; $CellContext`in = {$CellContext`yin, $CellContext`\[Phi]in}; 
          Null]; If[$CellContext`airQ != $CellContext`airQBuffer, 
          Unset[$CellContext`hardware]; $CellContext`airQBuffer = \
$CellContext`airQ; Null]; Null), $CellContext`degQ = 
       True, $CellContext`degQBuffer = True, $CellContext`\[Phi]in = 
       0, $CellContext`radToDeg[
         Pattern[$CellContext`rad, 
          Blank[]]] := 180 ($CellContext`rad/Pi), $CellContext`\[Phi]inBuffer = 
       0, $CellContext`degToRad[
         Pattern[$CellContext`deg, 
          Blank[]]] := Pi ($CellContext`deg/180), $CellContext`yin = 
       0, $CellContext`in = {0, 0}, $CellContext`airQ = 
       True, $CellContext`airQBuffer = True, $CellContext`paneAdd := Panel[
         Pane[
          Row[{
            Pane[
             
             Column[{$CellContext`paneAirQ, $CellContext`menuHardware, 
               "After position", $CellContext`menuPosition, \
$CellContext`buttonAdd}], $CellContext`sizePaneAdd1], \
$CellContext`switchHardware}, 
           Spacer[5]], $CellContext`sizePaneAddMain, 
          Alignment -> {Center, Center}], "Add element:", Top, FrameMargins -> 
         0], $CellContext`paneAirQ := $CellContext`setterAirQ, \
$CellContext`setterAirQ := SetterBar[
         Dynamic[$CellContext`airQ], {
         True -> "In air", False -> "In other medium"}, Appearance -> 
         "Vertical"], $CellContext`menuHardware := If[$CellContext`airQ, 
         PopupMenu[
          Dynamic[$CellContext`hardware], {
          "Choose", "Free space", "Thin lens", "Thick lens [air]" -> 
           "Thick lens", "Flat interface (in) [air]" -> "Flat interface (in)",
            "Flat interface (out) [air]" -> "Flat interface (out)", 
           "Curved interface (in) [air]" -> "Curved interface (in)", 
           "Curved interface (out) [air]" -> "Curved interface (out)", 
           "Flat mirror", "Curved mirror", "Apperture"}], 
         PopupMenu[
          Dynamic[$CellContext`hardware], {
          "Choose", "Slab" -> "Free space", "Thin lens", "Thick lens", 
           "Flat interface (in)", "Flat interface (out)", 
           "Curved interface (in)", "Curved interface (out)", "Flat mirror", 
           "Curved mirror", "Apperture"}]], $CellContext`menuPosition := 
       PopupMenu[
         Dynamic[$CellContext`positionAdd], 
         Range[
         0, Length[$CellContext`graphics] - 2]], $CellContext`positionAdd = 
       0, $CellContext`graphics = {{{
           GrayLevel[1], 
           Rectangle[{0, (-1)/2}]}, {
           Rotate[
            Line[{{0, 0}, {1, 0}}], 0, {1, 0}]}}, 
         Translate[
          Rotate[
           Line[{{0, 0}, {1, 0}}], 0, {0, 0}], {1, 
          0}]}, $CellContext`buttonAdd := 
       Button["Add", $CellContext`switchAdd; $CellContext`clearVariablesAdd; 
         Null, Enabled -> If[
           Apply[Or, 
            Map[# == 0& , $CellContext`input]], False, 
           True]], $CellContext`switchAdd := 
       Switch[$CellContext`hardware, "Choose", Null, 
         "Free space", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFreeSpace, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"d", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixFreeSpace, $CellContext`d -> 
             Part[$CellContext`input, 1]], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Slab", $CellContext`insertAfterGraphics[$CellContext`\
graphicsFreeSpace, $CellContext`positionAdd]; \
$CellContext`insertAfterParameters[{{"d", 
             Part[$CellContext`input, 1]}, {"n", 
             
             Part[$CellContext`input, 
              2]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixSlab, {$CellContext`d -> 
              Part[$CellContext`input, 1], $CellContext`n -> 
              Part[$CellContext`input, 2]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Thin lens", \
$CellContext`insertAfterGraphics[$CellContext`graphicsThinLens, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"f", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixLens, $CellContext`f -> 
             Part[$CellContext`input, 1]], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Thick lens [air]", \
$CellContext`insertAfterGraphics[$CellContext`graphicsThickLens, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"d", 
             Part[$CellContext`input, 1]}, {"r", 
             Part[$CellContext`input, 2]}, {"n", 
             
             Part[$CellContext`input, 
              3]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixThickLensAir, {$CellContext`d -> 
              Part[$CellContext`input, 1], $CellContext`r -> 
              Part[$CellContext`input, 2], $CellContext`n -> 
              Part[$CellContext`input, 3]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Thick lens", \
$CellContext`insertAfterGraphics[$CellContext`graphicsThickLens, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"d", 
             Part[$CellContext`input, 1]}, {"r", 
             Part[$CellContext`input, 2]}, {"n1", 
             Part[$CellContext`input, 3]}, {"n2", 
             
             Part[$CellContext`input, 
              4]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixThickLens, {$CellContext`d -> 
              Part[$CellContext`input, 1], $CellContext`r -> 
              Part[$CellContext`input, 2], $CellContext`n1 -> 
              Part[$CellContext`input, 3], $CellContext`n2 -> 
              Part[$CellContext`input, 4]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Flat interface (in) [air]", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFlatInterface, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"n", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixFlatInterfaceInAir, $CellContext`n -> 
             Part[$CellContext`input, 1]], 
            
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Flat interface (in)", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFlatInterface, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"n1", 
             Part[$CellContext`input, 1]}, {"n2", 
             
             Part[$CellContext`input, 
              2]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixFlatInterfaceIn, {$CellContext`n1 -> 
              Part[$CellContext`input, 1], $CellContext`n2 -> 
              Part[$CellContext`input, 2]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Flat interface (out) [air]", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFlatInterface, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"n", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixFlatInterfaceOutAir, $CellContext`n -> 
             Part[$CellContext`input, 1]], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Flat interface (out)", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFlatInterface, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"n1", 
             Part[$CellContext`input, 1]}, {"n2", 
             
             Part[$CellContext`input, 
              2]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixFlatInterfaceOut, {$CellContext`n1 -> 
              Part[$CellContext`input, 1], $CellContext`n2 -> 
              Part[$CellContext`input, 2]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Curved interface (in) [air]", \
$CellContext`insertAfterGraphics[$CellContext`graphicsCurvedInterfaceIn, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"r", 
             Part[$CellContext`input, 1]}, {"n", 
             
             Part[$CellContext`input, 
              2]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixCurvedInterfaceInAir, \
{$CellContext`r -> Part[$CellContext`input, 1], $CellContext`n -> 
              Part[$CellContext`input, 2]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Curved interface (in)", \
$CellContext`insertAfterGraphics[$CellContext`graphicsCurvedInterfaceIn, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"r", 
             Part[$CellContext`input, 1]}, {"n1", 
             Part[$CellContext`input, 2]}, {"n2", 
             
             Part[$CellContext`input, 
              3]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixCurvedInterfaceIn, {$CellContext`r -> 
              Part[$CellContext`input, 1], $CellContext`n1 -> 
              Part[$CellContext`input, 2], $CellContext`n2 -> 
              Part[$CellContext`input, 3]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Curved interface (out) [air]", \
$CellContext`insertAfterGraphics[$CellContext`graphicsCurvedInterfaceOut, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"r", 
             Part[$CellContext`input, 1]}, {"n", 
             
             Part[$CellContext`input, 
              2]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixCurvedInterfaceOutAir, \
{$CellContext`r -> Part[$CellContext`input, 1], $CellContext`n -> 
              Part[$CellContext`input, 2]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Curved interface (out)", \
$CellContext`insertAfterGraphics[$CellContext`graphicsCurvedInterfaceOut, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"r", 
             Part[$CellContext`input, 1]}, {"n1", 
             Part[$CellContext`input, 2]}, {"n2", 
             
             Part[$CellContext`input, 
              3]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixCurvedInterfaceOut, {$CellContext`r -> 
              Part[$CellContext`input, 1], $CellContext`n1 -> 
              Part[$CellContext`input, 2], $CellContext`n2 -> 
              Part[$CellContext`input, 3]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Flat mirror", \
$CellContext`insertAfterGraphics[$CellContext`graphicsFlatMirrorAir, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{}}, \
$CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, $CellContext`matrixFlatMirror, 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Curved mirror", \
$CellContext`insertAfterGraphics[$CellContext`graphicsCurvedMirrorAir, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"r", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixCurvedMirror, $CellContext`r -> 
             Part[$CellContext`input, 1]], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; Null, 
         "Apperture", \
$CellContext`insertAfterGraphics[$CellContext`graphicsNone, \
$CellContext`positionAdd]; $CellContext`insertAfterParameters[{{"\[Sigma]", 
             
             Part[$CellContext`input, 
              1]}}, $CellContext`positionAdd]; $CellContext`ABCDElements = 
          Insert[$CellContext`ABCDElements, 
            
            ReplaceAll[$CellContext`matrixApperture, {$CellContext`k -> \
$CellContext`kin, $CellContext`\[Sigma] -> Part[$CellContext`input, 1]}], 
            Length[$CellContext`ABCDElements] - $CellContext`positionAdd]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; 
         Null], $CellContext`insertAfterGraphics[
         Pattern[$CellContext`primitive, 
          Blank[]], 
         Pattern[$CellContext`index, 
          Blank[]]] := ($CellContext`graphics = Join[
          Part[$CellContext`graphics, 
           Span[1, $CellContext`index + 1]], {
           Translate[$CellContext`primitive, {$CellContext`index + 1, 0}]}, 
          Map[Translate[#, {1, 0}]& , 
           Part[$CellContext`graphics, 
            
            Span[$CellContext`index + 2, 
             All]]]]), $CellContext`graphicsFreeSpace = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}}, $CellContext`insertAfterParameters[
         Pattern[$CellContext`parameters, 
          Blank[]], 
         Pattern[$CellContext`index, 
          Blank[]]] := 
       If[Part[$CellContext`gParameters, 
           1] == {}, $CellContext`gParameters = {$CellContext`parameters}; 
         Null, $CellContext`gParameters = Join[
            Part[$CellContext`gParameters, 
             Span[1, $CellContext`index]], {$CellContext`parameters}, 
            Part[$CellContext`gParameters, 
             Span[$CellContext`index + 1, All]]]; 
         Null], $CellContext`gParameters = {{}}, $CellContext`input = 
       True, $CellContext`ABCDElements = {{{1, 0}, {0, 
        1}}}, $CellContext`matrixFreeSpace = {{1, $CellContext`d}, {0, 
         1}}, $CellContext`ABCD = {{1, 0}, {0, 
        1}}, $CellContext`matrixSlab = {{1, $CellContext`d/$CellContext`n}, {
         0, 1}}, $CellContext`graphicsThinLens = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {1/2, (-1)/2}}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`matrixLens = {{1, 
         0}, {(-1)/$CellContext`f, 1}}, $CellContext`graphicsThickLens = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Translate[
           
           BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {1/2, (-1)/2}}], {-0.15, 
            0}]}, {
          Translate[
           BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {1/2, (-1)/2}}], {0.15, 0}]}, {
          Line[{{0.35, 1/2}, {0.65, 1/2}}]}, {
          
          Line[{{0.35, (-1)/2}, {
            0.65, (-1)/2}}]}}, $CellContext`matrixThickLensAir = {{
         1 + ($CellContext`d - $CellContext`d \
$CellContext`n)/($CellContext`n^2 $CellContext`r), \
$CellContext`d/$CellContext`n^2}, {-(((-1 + $CellContext`n) ($CellContext`d - \
$CellContext`d $CellContext`n + 
             2 $CellContext`n^2 $CellContext`r))/($CellContext`n^2 \
$CellContext`r^2)), 
          1 + ($CellContext`d - $CellContext`d \
$CellContext`n)/($CellContext`n^2 $CellContext`r)}}, \
$CellContext`matrixThickLens = {{
         1 + ($CellContext`d ($CellContext`n1 - \
$CellContext`n2))/($CellContext`n2^2 $CellContext`r), ($CellContext`d \
$CellContext`n1)/$CellContext`n2^2}, {(($CellContext`n1 - $CellContext`n2) \
($CellContext`d ($CellContext`n1 - $CellContext`n2) + 
            2 $CellContext`n2^2 $CellContext`r))/($CellContext`n1 \
$CellContext`n2^2 $CellContext`r^2), 
          1 + ($CellContext`d ($CellContext`n1 - \
$CellContext`n2))/($CellContext`n2^2 $CellContext`r)}}, \
$CellContext`graphicsFlatInterface = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {
            1/2, (-1)/2}}]}}, $CellContext`matrixFlatInterfaceInAir = {{1, 
         0}, {0, $CellContext`n^(-1)}}, $CellContext`matrixFlatInterfaceIn = \
{{1, 0}, {
         0, $CellContext`n1/$CellContext`n2}}, \
$CellContext`matrixFlatInterfaceOutAir = {{1, 0}, {
         0, $CellContext`n}}, $CellContext`matrixFlatInterfaceOut = {{1, 0}, {
         0, $CellContext`n1/$CellContext`n2}}, \
$CellContext`graphicsCurvedInterfaceIn = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`matrixCurvedInterfaceInAir = {{1, 
         0}, {-((-1 + $CellContext`n)/($CellContext`n $CellContext`r)), \
$CellContext`n^(-1)}}, $CellContext`matrixCurvedInterfaceIn = {{1, 
         0}, {-((-$CellContext`n1 + $CellContext`n2)/($CellContext`n2 \
$CellContext`r)), $CellContext`n1/$CellContext`n2}}, \
$CellContext`graphicsCurvedInterfaceOut = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`matrixCurvedInterfaceOutAir = {{1, 
         0}, {(1 - $CellContext`n)/$CellContext`r, $CellContext`n}}, \
$CellContext`matrixCurvedInterfaceOut = {{1, 
         0}, {($CellContext`n1 - $CellContext`n2)/($CellContext`n1 \
$CellContext`r), $CellContext`n2/$CellContext`n1}}, \
$CellContext`graphicsFlatMirrorAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          
          Line[{{0, 0}, {0, (-1)/4}, {1, (-1)/4}, {1, 0}, {0, 
            0}}]}}, $CellContext`matrixFlatMirror = {{1, 0}, {0, 
        1}}, $CellContext`graphicsCurvedMirrorAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          BSplineCurve[{{0, 0}, {1/2, (-2)/5}, {1, 0}}]}, {
          
          Line[{{0, 0}, {0, (-1)/4}, {1, (-1)/4}, {1, 
            0}}]}}, $CellContext`matrixCurvedMirror = {{1, 
         0}, {(-2)/$CellContext`r, 1}}, $CellContext`graphicsNone = {{
          Line[{{0, (-1)/2}, {1, 1/2}}]}, {
          Line[{{0, 1/2}, {1, (-1)/2}}]}}, $CellContext`matrixApperture = {{1,
          0}, {((-2) I)/($CellContext`k $CellContext`\[Sigma]^2), 
          1}}, $CellContext`kin = (2 Pi)/
        695, $CellContext`clearVariablesAdd := ($CellContext`input = True; 
        Unset[$CellContext`hardware]; $CellContext`deleteNum = 
         "Choose"; $CellContext`positionAdd = 
         Length[$CellContext`graphics] - 2; $CellContext`airQ = 
         True; $CellContext`rQ = True; $CellContext`fInput = 0; 
        Null), $CellContext`deleteNum = "Choose", $CellContext`rQ = 
       True, $CellContext`fInput = 
       0, $CellContext`sizePaneAdd1 = {140, 220}, $CellContext`switchHardware := 
       Switch[$CellContext`hardware, "Choose", $CellContext`paneNone, 
         "Free space", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {0}]; $CellContext`paneFreeSpace, "Slab",
          If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            2], $CellContext`input = {0, 0}]; $CellContext`paneSlab, 
         "Thin lens", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {0}]; $CellContext`paneLens, 
         "Thick lens [air]", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            3], $CellContext`input = {0, 0, 
            0}]; $CellContext`paneThickLensAir, "Thick lens", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            4], $CellContext`input = {0, 0, 0, 
            0}]; $CellContext`paneThickLens, "Flat interface (in) [air]", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {
            0}]; $CellContext`paneFlatInterfaceInAir, "Flat interface (in)", 
         If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            2], $CellContext`input = {0, 
            0}]; $CellContext`paneFlatInterfaceIn, 
         "Flat interface (out) [air]", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {
            0}]; $CellContext`paneFlatInterfaceOutAir, "Flat interface (out)",
          If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            2], $CellContext`input = {0, 
            0}]; $CellContext`paneFlatInterfaceOut, 
         "Curved interface (in) [air]", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            2], $CellContext`input = {0, 
            0}]; $CellContext`paneCurvedInterfaceInAir, 
         "Curved interface (in)", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            3], $CellContext`input = {0, 0, 
            0}]; $CellContext`paneCurvedInterfaceIn, 
         "Curved interface (out) [air]", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            2], $CellContext`input = {0, 
            0}]; $CellContext`paneCurvedInterfaceOutAir, 
         "Curved interface (out)", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            3], $CellContext`input = {0, 0, 
            0}]; $CellContext`paneCurvedInterfaceOut, "Flat mirror", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            0], $CellContext`input = {}]; $CellContext`paneFlatMirror, 
         "Curved mirror", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {0}]; $CellContext`paneCurvedMirror, 
         "Apperture", If[
           Or[
            TrueQ[$CellContext`input], Length[$CellContext`input] != 
            1], $CellContext`input = {
            0}]; $CellContext`paneApperture], $CellContext`paneNone := 
       Pane[Null, $CellContext`sizeHardware], $CellContext`sizeHardware = {
        100, 220}, $CellContext`paneFreeSpace := Pane[
         Column[{
           Graphics[$CellContext`graphicsTextFreeSpace, ImageSize -> Tiny], 
           Row[{"d = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextFreeSpace = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["d", Large, Italic], {1/2, 1/10}]}, {
          Arrowheads[{-0.1, 0.1}], 
          Arrow[{{0, 0}, {1, 0}}]}}, $CellContext`sizeInputFieldHardware = 
       3, $CellContext`paneSlab := Pane[
         Column[{
           Graphics[$CellContext`graphicsTextSlab, ImageSize -> Tiny], 
           Row[{"d = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], $CellContext`graphicsTextSlab = \
{{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["d", Large, Italic], {1/2, 1/10}]}, {
          Text[
           Style["n", Large, Italic], {0.5, (-1)/3}]}, {
          Arrowheads[{-0.1, 0.1}], 
          Arrow[{{0, 0}, {1, 0}}]}}, $CellContext`paneLens := Pane[
         Column[{
           Graphics[$CellContext`graphicsTextThinLensAir, ImageSize -> Tiny], 
           Row[{"f = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextThinLensAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["f", Large, Italic], {0.3, 1/3}]}, {
          BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {1/2, (-1)/2}}]}, {
          BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`paneThickLensAir := Pane[
         Column[{
           Graphics[$CellContext`graphicsTextThickLensAir, ImageSize -> Tiny], 
           Row[{"d = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 3]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           RadioButtonBar[
            Dynamic[$CellContext`rQ], {True -> Row[{"r = ", 
                InputField[
                 Dynamic[
                  Part[$CellContext`input, 2], (
                  Part[$CellContext`input, 2] = #; $CellContext`fInput = Quiet[
                    Check[
                    N[
                    ReplaceAll[
                    $CellContext`rToF[#], {$CellContext`d -> 
                    Part[$CellContext`input, 1], $CellContext`n1 -> 
                    1, $CellContext`n2 -> Part[$CellContext`input, 3]}]], 
                    Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[$CellContext`rQ], ContinuousAction -> 
                 True]}], False -> Row[{"f = ", 
                InputField[
                 
                 Dynamic[$CellContext`fInput, ($CellContext`fInput = #; 
                  Part[$CellContext`input, 2] = Quiet[
                    Check[
                    N[
                    ReplaceAll[
                    $CellContext`fToR[#], {$CellContext`d -> 
                    Part[$CellContext`input, 1], $CellContext`n1 -> 
                    1, $CellContext`n2 -> Part[$CellContext`input, 3]}]], 
                    Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[
                   Not[$CellContext`rQ]], ContinuousAction -> True]}]}, 
            Appearance -> "Vertical"]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextThickLensAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["f", Large, Italic], {0.15, 1/3}]}, {
          Text[
           Style["r", Large, Italic], {0.4, 1/3}]}, {
          Text[
           Style["d", Large, Italic], {0.5, 1/10}]}, {
          Text[
           Style["n", Large, Italic], {0.5, (-1)/3}]}, {
          Arrowheads[{-0.1, 0.1}], 
          Arrow[{{0.85, 0}, {0.15, 0}}]}, {
          Translate[
           
           BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {1/2, (-1)/2}}], {-0.15, 
            0}]}, {
          Translate[
           BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {1/2, (-1)/2}}], {0.15, 0}]}, {
          Line[{{0.35, 1/2}, {0.65, 1/2}}]}, {
          Line[{{0.35, (-1)/2}, {0.65, (-1)/2}}]}}, $CellContext`rToF[
         Pattern[$CellContext`r, 
          
          Blank[]]] := ($CellContext`n1 $CellContext`n2 \
$CellContext`r^2)/($CellContext`d (-1 + $CellContext`n2)^2), $CellContext`fToR[
         Pattern[$CellContext`f, 
          Blank[]]] := (Sqrt[$CellContext`d] 
         Sqrt[$CellContext`f] (-1 + $CellContext`n2))/(Sqrt[$CellContext`n1] 
        Sqrt[$CellContext`n2]), $CellContext`paneThickLens := Pane[
         Column[{
           Graphics[$CellContext`graphicsTextThickLens, ImageSize -> Tiny], 
           Row[{"d = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(1\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 3]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(2\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 4]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           RadioButtonBar[
            Dynamic[$CellContext`rQ], {True -> Row[{"r = ", 
                InputField[
                 Dynamic[
                  Part[$CellContext`input, 2], (
                  Part[$CellContext`input, 2] = #; $CellContext`fInput = Quiet[
                    Check[
                    N[
                    ReplaceAll[
                    $CellContext`rToF[#], {$CellContext`d -> 
                    Part[$CellContext`input, 1], $CellContext`n1 -> 
                    Part[$CellContext`input, 3], $CellContext`n2 -> 
                    Part[$CellContext`input, 4]}]], Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[$CellContext`rQ], ContinuousAction -> 
                 True]}], False -> Row[{"f = ", 
                InputField[
                 
                 Dynamic[$CellContext`fInput, ($CellContext`fInput = #; 
                  Part[$CellContext`input, 2] = Quiet[
                    Check[
                    N[
                    ReplaceAll[
                    $CellContext`fToR[#], {$CellContext`d -> 
                    Part[$CellContext`input, 1], $CellContext`n1 -> 
                    Part[$CellContext`input, 3], $CellContext`n2 -> 
                    Part[$CellContext`input, 4]}]], Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[
                   Not[$CellContext`rQ]], ContinuousAction -> True]}]}, 
            Appearance -> "Vertical"]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextThickLens = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["f", Large, Italic], {0.15, 1/3}]}, {
          Text[
           Style["r", Large, Italic], {0.4, 1/3}]}, {
          Text[
           Style["d", Large, Italic], {0.5, 1/10}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(1\)]\)", Large, Italic], {
           0.1, (-1)/3}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(2\)]\)", Large, Italic], {
           0.5, (-1)/3}]}, {
          Arrowheads[{-0.1, 0.1}], 
          Arrow[{{0.85, 0}, {0.15, 0}}]}, {
          Translate[
           
           BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {1/2, (-1)/2}}], {-0.15, 
            0}]}, {
          Translate[
           BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {1/2, (-1)/2}}], {0.15, 0}]}, {
          Line[{{0.35, 1/2}, {0.65, 1/2}}]}, {
          
          Line[{{0.35, (-1)/2}, {
            0.65, (-1)/2}}]}}, $CellContext`paneFlatInterfaceInAir := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextFlatInterfaceInAir, ImageSize -> 
            Tiny], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextFlatInterfaceInAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["n", Large, Italic], {0.6, (-1)/3}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {
            1/2, (-1)/2}}]}}, $CellContext`paneFlatInterfaceIn := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextFlatInterfaceIn, ImageSize -> 
            Tiny], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(1\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(2\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextFlatInterfaceIn = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(1\)]\)", Large, Italic], {
           0.1, (-1)/3}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(2\)]\)", Large, Italic], {
           0.7, (-1)/3}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {
            1/2, (-1)/2}}]}}, $CellContext`paneFlatInterfaceOutAir := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextFlatInterfaceOutAir, ImageSize -> 
            Tiny], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextFlatInterfaceOutAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["n", Large, Italic], {0.4, (-1)/3}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {
            1/2, (-1)/2}}]}}, $CellContext`paneFlatInterfaceOut := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextFlatInterfaceOut, ImageSize -> 
            Tiny], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(1\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(2\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextFlatInterfaceOut = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(1\)]\)", Large, Italic], {
           0.9, (-1)/3}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(2\)]\)", Large, Italic], {
           0.35, (-1)/3}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {
            1/2, (-1)/2}}]}}, $CellContext`paneCurvedInterfaceInAir := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextCurvedInterfaceInAir, ImageSize -> 
            Tiny], 
           Row[{"r = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextCurvedInterfaceInAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["r", Large, Italic], {0.6, 1/10}]}, {
          Text[
           Style["n", Large, Italic], {0.6, (-1)/3}]}, {
          Arrowheads[{0.1}], 
          Arrow[{{3/4, 0}, {3/10, 0}}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`paneCurvedInterfaceIn := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextCurvedInterfaceIn, ImageSize -> 
            Tiny], 
           Row[{"r = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(1\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(2\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 3]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextCurvedInterfaceIn = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["r", Large, Italic], {0.6, 1/10}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(1\)]\)", Large, Italic], {
           0.1, (-1)/3}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(2\)]\)", Large, Italic], {
           0.6, (-1)/3}]}, {
          Arrowheads[{0.1}], 
          Arrow[{{3/4, 0}, {3/10, 0}}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {1/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`paneCurvedInterfaceOutAir := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextCurvedInterfaceOutAir, ImageSize -> 
            Tiny], 
           Row[{"r = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"n = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextCurvedInterfaceOutAir = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["r", Large, Italic], {0.4, 1/10}]}, {
          Text[
           Style["n", Large, Italic], {0.4, (-1)/3}]}, {
          Arrowheads[{0.1}], 
          Arrow[{{1/4, 0}, {7/10, 0}}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`paneCurvedInterfaceOut := Pane[
         Column[{
           
           Graphics[$CellContext`graphicsTextCurvedInterfaceOut, ImageSize -> 
            Tiny], 
           Row[{"r = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(1\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 2]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}], 
           Row[{"\!\(\*SubscriptBox[\(n\), \(2\)]\) = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 3]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsTextCurvedInterfaceOut = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          Text[
           Style["r", Large, Italic], {0.4, 1/10}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(1\)]\)", Large, Italic], {
           0.9, (-1)/3}]}, {
          Text[
           Style["\!\(\*SubscriptBox[\(n\), \(2\)]\)", Large, Italic], {
           0.4, (-1)/3}]}, {
          Arrowheads[{0.1}], 
          Arrow[{{1/4, 0}, {7/10, 0}}]}, {
          
          BSplineCurve[{{1/2, 1/2}, {9/10, 0}, {
            1/2, (-1)/2}}]}}, $CellContext`paneFlatMirror := Pane[
         Column[{
           Graphics[$CellContext`graphicsFlatMirrorAir, ImageSize -> Tiny]}, 
          Center], $CellContext`sizeHardware], $CellContext`paneCurvedMirror := 
       Pane[
         Column[{
           
           Graphics[$CellContext`graphicsCurvedMirrorAirText, ImageSize -> 
            Tiny], 
           RadioButtonBar[
            Dynamic[$CellContext`rQ], {True -> Row[{"r = ", 
                InputField[
                 Dynamic[
                  Part[$CellContext`input, 1], (
                  Part[$CellContext`input, 1] = #; $CellContext`fInput = Quiet[
                    Check[
                    N[
                    $CellContext`rToFMirror[#]], Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[$CellContext`rQ], ContinuousAction -> 
                 True]}], False -> Row[{"f = ", 
                InputField[
                 
                 Dynamic[$CellContext`fInput, ($CellContext`fInput = #; 
                  Part[$CellContext`input, 1] = Quiet[
                    Check[
                    N[
                    $CellContext`fToRMirror[#]], Infinity]])& ], Number, 
                 FieldSize -> {$CellContext`sizeInputFieldHardware, 1}, 
                 Enabled -> Dynamic[
                   Not[$CellContext`rQ]], ContinuousAction -> True]}]}, 
            Appearance -> "Vertical"]}, 
          Center], $CellContext`sizeHardware], \
$CellContext`graphicsCurvedMirrorAirText = {{
          GrayLevel[1], 
          Rectangle[{0, (-1)/2}]}, {
          BSplineCurve[{{0, 0}, {1/2, (-2)/5}, {1, 0}}]}, {
          Line[{{0, 0}, {0, (-1)/4}, {1, (-1)/4}, {1, 0}}]}, {
          Arrowheads[{0.1}], 
          Translate[
           Rotate[
            Arrow[{{1/4, 0}, {7/10, 0}}], -Pi/2], {0, 1/50}]}, {
          Text[
           Style["r", Large, Italic], {0.4, 1/6}]}}, $CellContext`rToFMirror[
         Pattern[$CellContext`r, 
          Blank[]]] := $CellContext`r/2, $CellContext`fToRMirror[
         Pattern[$CellContext`f, 
          Blank[]]] := 2 $CellContext`f, $CellContext`paneApperture := Pane[
         Column[{
           Graphics[$CellContext`graphicsNone, ImageSize -> Tiny], 
           Row[{"\[Sigma] = ", 
             InputField[
              Dynamic[
               Part[$CellContext`input, 1]], Number, 
              FieldSize -> $CellContext`sizeInputFieldHardware, 
              ContinuousAction -> True]}]}, 
          Center], $CellContext`sizeHardware], $CellContext`sizePaneAddMain = \
{260, 210}, $CellContext`paneDelete := Panel[
         Pane[
          Column[{
            
            Row[{"Element number ", $CellContext`menuDelete}], \
$CellContext`buttonDelete}, Center], $CellContext`sizePaneDelete, 
          Alignment -> {Center, Center}], "Delete element:", Top, 
         FrameMargins -> 0], $CellContext`menuDelete := PopupMenu[
         Dynamic[$CellContext`deleteNum], 
         Join[{"Choose"}, 
          Range[
          Length[$CellContext`ABCDElements] - 1]]], $CellContext`buttonDelete := 
       Button["Delete", $CellContext`deleteABCDElement; \
$CellContext`deleteParameter; $CellContext`deleteGraphicsElement; \
$CellContext`clearVariablesAdd; Null, Enabled -> 
         If[$CellContext`deleteNum == "Choose", False, 
           True]], $CellContext`deleteABCDElement := \
($CellContext`ABCDElements = 
         Delete[$CellContext`ABCDElements, 
           Length[$CellContext`ABCDElements] - $CellContext`deleteNum]; \
$CellContext`ABCD = Apply[Dot, $CellContext`ABCDElements]; 
        Null), $CellContext`deleteParameter := ($CellContext`gParameters = 
         Delete[$CellContext`gParameters, $CellContext`deleteNum]; 
        If[$CellContext`gParameters == {}, $CellContext`gParameters = {{}}; 
          Null]; Null), $CellContext`deleteGraphicsElement := \
($CellContext`graphics = Join[
           Part[$CellContext`graphics, 
            Span[1, $CellContext`deleteNum + 1]], 
           Table[
            Translate[
             Part[$CellContext`graphics, $CellContext`i], {-1, 
             0}], {$CellContext`i, $CellContext`deleteNum + 2, 
             Length[$CellContext`graphics]}]]; $CellContext`graphics = 
         Delete[$CellContext`graphics, $CellContext`deleteNum + 1]; 
        Null), $CellContext`sizePaneDelete = {260, 
        69}, $CellContext`buttonClearElements = 
       Button["Clear elements", $CellContext`clearElements], \
$CellContext`clearElements := ($CellContext`clearVariablesAdd; \
$CellContext`ABCD = {{1, 0}, {0, 
          1}}; $CellContext`ABCDElements = {$CellContext`ABCD}; \
$CellContext`graphics = {
           $CellContext`graphicsBeamIn[$CellContext`in], 
           Translate[
            $CellContext`graphicsBeamOut[$CellContext`out], {1, 
            0}]}; $CellContext`gParameters = {{}}; \
$CellContext`clearVariablesAdd; Null), $CellContext`graphicsBeamIn[
         Pattern[$CellContext`in, 
          Blank[]]] := {{White, 
          Rectangle[{0, (-1)/2}]}, {
          Rotate[
           Line[{{0, 
              Part[$CellContext`in, 1]}, {1, 
              Part[$CellContext`in, 1]}}], 
           Part[$CellContext`in, 2], {1, 
            Part[$CellContext`in, 1]}]}}, $CellContext`graphicsBeamOut[
         Pattern[$CellContext`out, 
          Blank[]]] := Rotate[
         Line[{{0, 
            Part[$CellContext`out, 1]}, {1, 
            Part[$CellContext`out, 1]}}], 
         Part[$CellContext`out, 2], {0, 
          Part[$CellContext`out, 1]}], $CellContext`out = {0, 
        0}, $CellContext`paneVisualisation := Column[{
          Pane[
           Graphics[
            
            Join[$CellContext`graphics, $CellContext`graphicsNumbers, \
$CellContext`graphicsParameters, {$CellContext`graphicsElementNumberText}], 
            ImageSize -> $CellContext`sizeVisualisation], Scrollbars -> False,
            AppearanceElements -> None, Alignment -> {Center, Center}], 
          Row[{
            StringJoin["ABCD matrix", " = "], 
            MatrixForm[
             ComplexExpand[$CellContext`ABCD]]}], 
          Row[{
            Column[{
              StringJoin["\!\(\*SubscriptBox[\(y\), \(out\)]\) = ", 
               ToString[
                TraditionalForm[
                 N[Part[$CellContext`out, 1] 20]]], 
               " mm, \!\(\*SubscriptBox[\(\[Phi]\), \(out\)]\) = ", 
               ToString[
                TraditionalForm[
                 N[
                  If[$CellContext`degQ, 
                   $CellContext`radToDeg[
                    Part[$CellContext`out, 2]], 
                   Part[$CellContext`out, 2]]]]], 
               If[$CellContext`degQ, " deg", " rad"]], 
              StringJoin["\!\(\*SubscriptBox[\(\[Omega]\), \(out\)]\) = ", 
               ToString[
                TraditionalForm[
                 N[
                  $CellContext`\[Omega]out[
                   
                   Part[$CellContext`\[Omega]s, 
                    1], $CellContext`ABCD, $CellContext`kin]]]], " mm"], 
              StringJoin["Radius = ", 
               ToString[
                TraditionalForm[
                 Quiet[
                  Check[
                   N[
                    $CellContext`Rout[$CellContext`\[Omega]s, \
$CellContext`ABCD, $CellContext`kin]], Infinity]]]], " ???", 
               ", Phase shift = ", 
               ToString[
                TraditionalForm[
                 Quiet[
                  Check[
                   N[
                    If[$CellContext`degQ, 
                    $CellContext`radToDeg[
                    $CellContext`\[Delta]out[
                    
                    Part[$CellContext`\[Omega]s, 
                    1], $CellContext`ABCD, $CellContext`kin]], 
                    $CellContext`\[Delta]out[
                    
                    Part[$CellContext`\[Omega]s, 
                    1], $CellContext`ABCD, $CellContext`kin]]], Infinity]]]], 
               If[$CellContext`degQ, " deg", " rad"]]}, Center]}]}, 
         Center], $CellContext`graphicsNumbers := Table[
         Text[
          Style[
           ToString[$CellContext`i], FontSize -> Medium], {$CellContext`i + 
           0.5, 1}], {$CellContext`i, Length[$CellContext`graphics] - 
          2}], $CellContext`graphicsParameters := 
       If[Flatten[$CellContext`gParameters] == {}, {}, 
         Table[
          Text[
           Style[
            StringJoin[
             Table[
              StringJoin[
               
               Part[$CellContext`gParameters, $CellContext`i, $CellContext`j, 
                1], " = ", 
               ToString[
                
                Part[$CellContext`gParameters, $CellContext`i, $CellContext`j,
                  2]], "\n"], {$CellContext`j, 
               Length[
                Part[$CellContext`gParameters, $CellContext`i]]}]], FontSize -> 
            Medium], {$CellContext`i + 0.5, -1}], {$CellContext`i, 
           
           Length[$CellContext`gParameters]}]], \
$CellContext`graphicsElementNumberText := 
       If[Length[$CellContext`graphics] == 2, {}, 
         Text[
          Style["Element number:", FontSize -> Medium], {
          0.5, 1}]], $CellContext`sizeVisualisation = {400, 
        200}, $CellContext`\[Omega]out[
         Pattern[$CellContext`\[Omega]in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]]] := 
       Re[$CellContext`\[Omega]in 
         Sqrt[Part[$CellContext`ABCD, 1, 1]^2 + (
             2 (Part[$CellContext`ABCD, 1, 
                2]/($CellContext`k $CellContext`\[Omega]in^2)))^2]], \
$CellContext`\[Omega]in = 
       1, $CellContext`\[Omega]s = {1, 1}, $CellContext`Rout[
         Pattern[$CellContext`\[Omega]in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]]] := 
       Re[1/((Part[$CellContext`\[Omega]in, 1]/
           Part[$CellContext`\[Omega]in, 2])^2 (
          Part[$CellContext`ABCD, 1, 1] Part[$CellContext`ABCD, 2, 1] + 
          Part[$CellContext`ABCD, 1, 2] 
           Part[$CellContext`ABCD, 2, 2] (2/($CellContext`k 
             Part[$CellContext`\[Omega]in, 1]))^2))], $CellContext`\[Delta]out[
         Pattern[$CellContext`\[Omega]in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]], 
         Pattern[$CellContext`k, 
          Blank[]]] := Re[
         ArcTan[(2 (Pi/$CellContext`k)) (Part[$CellContext`ABCD, 1, 2]/(
           Pi $CellContext`\[Omega]in^2 
           Part[$CellContext`ABCD, 1, 1]))]], $CellContext`paneIn := 
       Column[{$CellContext`paneDegQ, $CellContext`paneYIn, $CellContext`pane\
\[Phi]In, Null, $CellContext`pane\[Lambda]In, 
          Null, $CellContext`pane\[Omega]In}, Center], $CellContext`paneDegQ := 
       Row[{"Unit of angles: ", $CellContext`setterDegQ}], \
$CellContext`setterDegQ := SetterBar[
         Dynamic[$CellContext`degQ, {($CellContext`degQ = #)& , \
$CellContext`updateSomeTimes; Null}], {
         True -> "degrees", False -> 
          "radians"}], $CellContext`updateSomeTimes := (
        Part[$CellContext`graphics, 
           1] = $CellContext`graphicsBeamIn[$CellContext`in]; 
        Part[$CellContext`graphics, -1] = Translate[
           $CellContext`graphicsBeamOut[$CellContext`out], {
           Length[$CellContext`graphics] - 1, 
            0}]; $CellContext`out = $CellContext`outFun[$CellContext`in, \
$CellContext`ABCD]; $CellContext`\[Omega]s = {$CellContext`\[Omega]in, 
           $CellContext`\[Omega]out[$CellContext`\[Omega]in, \
$CellContext`ABCD, $CellContext`kin]}; Null), $CellContext`outFun[
         Pattern[$CellContext`in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]]] := {
         $CellContext`yout[$CellContext`in, $CellContext`ABCD], 
         $CellContext`\[Phi]out[$CellContext`in, $CellContext`ABCD]}, \
$CellContext`yout[
         Pattern[$CellContext`in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]]] := 
       Re[Part[$CellContext`ABCD, 1, 1] Part[$CellContext`in, 1] + 
         Part[$CellContext`ABCD, 1, 2] 
          Part[$CellContext`in, 2]], $CellContext`\[Phi]out[
         Pattern[$CellContext`in, 
          Blank[]], 
         Pattern[$CellContext`ABCD, 
          Blank[]]] := 
       Re[Part[$CellContext`ABCD, 2, 1] Part[$CellContext`in, 1] + 
         Part[$CellContext`ABCD, 2, 2] 
          Part[$CellContext`in, 2]], $CellContext`paneYIn := 
       Column[{"\!\(\*SubscriptBox[\(y\), \(in\)]\) [mm]", \
$CellContext`manipulatorYIn}, Center], $CellContext`manipulatorYIn := 
       Manipulator[
         Dynamic[$CellContext`yinBuffer, {($CellContext`yinBuffer = #)& , \
($CellContext`yin = #/20)& }], {-10, 10}, AppearanceElements -> "InputField", 
         Appearance -> "Open", ContinuousAction -> 
         True], $CellContext`yinBuffer = 0, $CellContext`pane\[Phi]In := 
       Column[{
          StringJoin["\!\(\*SubscriptBox[\(\[Phi]\), \(in\)]\) [", 
           If[$CellContext`degQ, "deg", "rad"], 
           "]"], $CellContext`manipulator\[Phi]In}, 
         Center], $CellContext`manipulator\[Phi]In := Manipulator[
         Dynamic[$CellContext`\[Phi]inBuffer, {($CellContext`\[Phi]inBuffer = \
#)& , ($CellContext`\[Phi]in = ($CellContext`\[Phi]inBuffer = #))& }], 
         If[$CellContext`degQ, {-30, 30}, {-Pi/6, Pi/6}], AppearanceElements -> 
         "InputField", Appearance -> "Open", ContinuousAction -> 
         True], $CellContext`pane\[Lambda]In := RadioButtonBar[
         Dynamic[$CellContext`\[Lambda]Q], {True -> Row[{"\[Lambda] [nm] ", 
             InputField[
              
              Dynamic[$CellContext`\[Lambda]inBuffer, \
{($CellContext`\[Lambda]inBuffer = #)& , ($CellContext`\[Lambda]in = #/
                  10^6; $CellContext`kin = Quiet[
                   N[
                    $CellContext`\[Lambda]tok[$CellContext`\[Lambda]in]]]; \
$CellContext`kinBuffer = $CellContext`kin/10^6)& }], Number, 
              FieldSize -> {$CellContext`sizeInputFieldIn, 1}, Enabled -> 
              Dynamic[$CellContext`\[Lambda]Q], ContinuousAction -> False]}], 
          False -> Row[{"k [\!\(\*SuperscriptBox[\(nm\), \(-1\)]\)] ", 
             InputField[
              
              Dynamic[$CellContext`kinBuffer, {($CellContext`kinBuffer = #)& \
, ($CellContext`kin = # 10^6; $CellContext`\[Lambda]in = Quiet[
                   N[
                    $CellContext`kto\[Lambda][$CellContext`kin]]]; \
$CellContext`\[Lambda]inBuffer = $CellContext`\[Lambda]in 10^6)& }], Number, 
              FieldSize -> {$CellContext`sizeInputFieldIn, 1}, Enabled -> 
              Dynamic[
                Not[$CellContext`\[Lambda]Q]], ContinuousAction -> False]}]}, 
         Appearance -> "Horizontal"], $CellContext`\[Lambda]Q = 
       True, $CellContext`\[Lambda]in = 695, $CellContext`\[Lambda]tok[
         Pattern[$CellContext`\[Lambda], 
          Blank[]]] := 
       2 (Pi/$CellContext`\[Lambda]), $CellContext`sizeInputFieldIn = 
       4, $CellContext`kto\[Lambda][
         Pattern[$CellContext`k, 
          Blank[]]] := 2 (Pi/$CellContext`k), $CellContext`pane\[Omega]In := 
       Column[{"\!\(\*SubscriptBox[\(\[Omega]\), \(in\)]\) [mm]", \
$CellContext`manipulator\[Omega]In}, 
         Center], $CellContext`manipulator\[Omega]In := Manipulator[
         Dynamic[$CellContext`\[Omega]in], {0.1, 10}, AppearanceElements -> 
         "InputField", Appearance -> "Open", ContinuousAction -> 
         False], $CellContext`buttonClearInput = 
       Button["Clear input", $CellContext`clearInput], \
$CellContext`clearInput := ($CellContext`in = {0, 0}; $CellContext`out = {0, 
          0}; $CellContext`yin = 
         0; $CellContext`yinBuffer = $CellContext`yin; $CellContext`\[Phi]in = 
         0; $CellContext`\[Phi]inBuffer = $CellContext`\[Phi]in; \
$CellContext`\[Lambda]Q = True; $CellContext`\[Lambda]in = 
         695/10^6; $CellContext`\[Lambda]inBuffer = $CellContext`\[Lambda]in 
          10^6; $CellContext`kin = $CellContext`\[Lambda]tok[$CellContext`\
\[Lambda]in]; $CellContext`kinBuffer = $CellContext`kin/
          10^6; $CellContext`\[Omega]in = 1; 
        Null), $CellContext`buttonClearAll = 
       Button["Clear all", $CellContext`clearAll], $CellContext`clearAll := \
($CellContext`ABCD = {{1, 0}, {0, 
          1}}; $CellContext`ABCDElements = {$CellContext`ABCD}; \
$CellContext`in = {0, 0}; $CellContext`out = {0, 0}; $CellContext`graphics = {
           $CellContext`graphicsBeamIn[$CellContext`in], 
           Translate[
            $CellContext`graphicsBeamOut[$CellContext`out], {1, 
            0}]}; $CellContext`yin = 
         0; $CellContext`yinBuffer = $CellContext`yin; $CellContext`\[Phi]in = 
         0; $CellContext`\[Phi]inBuffer = $CellContext`\[Phi]in; \
$CellContext`gParameters = {{}}; $CellContext`\[Lambda]Q = 
         True; $CellContext`\[Lambda]in = 
         695; $CellContext`kin = $CellContext`\[Lambda]tok[$CellContext`\
\[Lambda]in]; $CellContext`\[Omega]in = 1; $CellContext`clearVariablesAdd; 
        Null)}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.5913091987027884`*^9}]
}, {2}]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bibliografia", "Section",
 CellChangeTimes->{{3.5913081804635477`*^9, 3.5913081858368554`*^9}}],

Cell[CellGroupData[{

Cell["\<\
[1] Hanson S. G., Jakobsen M. L., Yura H. T. \
\[OpenCurlyDoubleQuote]Complex-valued ABCD Matrices\[CloseCurlyDoubleQuote]\
\>", "Reference",
 CellChangeTimes->{{3.591308207872116*^9, 3.591308276603047*^9}, {
  3.5913088561541953`*^9, 3.591308858752344*^9}, {3.59130906709426*^9, 
  3.5913090674492807`*^9}}],

Cell["\<\
[2] Yura H. T., Hanson S. G. \[OpenCurlyDoubleQuote]Optical beam wave \
propagation through complex optical systems\[CloseCurlyDoubleQuote], J. Opt. \
Soc. Am. A, 1987, vol. 4 no. 10, strony 1931-1948\
\>", "Reference",
 CellChangeTimes->{{3.591308915537592*^9, 3.5913090161643476`*^9}, {
  3.5913090701904373`*^9, 3.59130907058146*^9}}],

Cell["[3] Pomoc programu Mathematica", "Reference",
 CellChangeTimes->{{3.5913090255438843`*^9, 3.5913090382466106`*^9}, {
  3.5913090728195877`*^9, 3.591309073133606*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1222, 876},
WindowMargins->{{6, Automatic}, {Automatic, 1}},
Magnification->1.0999999046325684`,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Book"}, "Textbook.nb", CharacterEncoding -> 
       "WindowsEastEurope"]]], 
   Cell[
    StyleData[All]], 
   Cell[
    StyleData["Title"]]}, WindowSize -> {707, 787}, 
  WindowMargins -> {{48, Automatic}, {Automatic, 60}}, Visible -> False, 
  FrontEndVersion -> "9.0 for Microsoft Windows (32-bit) (January 25, 2013)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 123, 1, 42, "Author"],
Cell[683, 23, 266, 4, 15, "Department"],
Cell[CellGroupData[{
Cell[974, 31, 110, 1, 89, "Title"],
Cell[1087, 34, 179, 4, 74, "Subtitle"],
Cell[CellGroupData[{
Cell[1291, 42, 94, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[1410, 47, 113, 1, 35, "Subsection"],
Cell[1526, 50, 1337, 20, 97, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2900, 75, 106, 1, 35, "Subsection"],
Cell[3009, 78, 1006, 15, 60, "Text"],
Cell[4018, 95, 513, 9, 42, "Text"],
Cell[CellGroupData[{
Cell[4556, 108, 419, 7, 40, "ItemNumbered"],
Cell[4978, 117, 964, 14, 56, "ItemNumbered"],
Cell[5945, 133, 540, 9, 40, "ItemNumbered"],
Cell[6488, 144, 526, 8, 40, "ItemNumbered"]
}, Open  ]],
Cell[7029, 155, 615, 10, 60, "Text"],
Cell[7647, 167, 1038, 16, 60, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8722, 188, 103, 1, 35, "Subsection"],
Cell[8828, 191, 1030, 16, 60, "Text"],
Cell[9861, 209, 765, 13, 60, "Text"],
Cell[10629, 224, 646, 10, 60, "Text"],
Cell[11278, 236, 928, 14, 60, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[12255, 256, 101, 1, 40, "Section"],
Cell[CellGroupData[{
Cell[12381, 261, 101, 1, 35, "Subsection"],
Cell[12485, 264, 1899, 49, 73, "Input"],
Cell[14387, 315, 3279, 87, 93, "Input"],
Cell[17669, 404, 399, 11, 53, "Input"],
Cell[18071, 417, 454, 12, 53, "Input"],
Cell[18528, 431, 1228, 38, 146, "Input"],
Cell[19759, 471, 1876, 52, 73, "Input"],
Cell[21638, 525, 1119, 30, 53, "Input"],
Cell[22760, 557, 1306, 29, 133, "Input"],
Cell[24069, 588, 1288, 23, 213, "Input"],
Cell[25360, 613, 2567, 53, 373, "Input"],
Cell[27930, 668, 1205, 29, 193, "Input"],
Cell[29138, 699, 1545, 35, 313, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30720, 739, 107, 1, 35, "Subsection"],
Cell[30830, 742, 269, 4, 32, "Input"],
Cell[31102, 748, 2448, 51, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33587, 804, 110, 1, 35, "Subsection"],
Cell[33700, 807, 832, 19, 213, "Input"],
Cell[34535, 828, 821, 21, 133, "Input"],
Cell[35359, 851, 2276, 48, 253, "Input"],
Cell[37638, 901, 1426, 40, 113, "Input"],
Cell[39067, 943, 902, 27, 32, "Input"],
Cell[39972, 972, 1679, 43, 133, "Input"],
Cell[41654, 1017, 1608, 47, 153, "Input"],
Cell[43265, 1066, 485, 13, 93, "Input"],
Cell[43753, 1081, 2055, 59, 153, "Input"],
Cell[45811, 1142, 2315, 68, 173, "Input"],
Cell[48129, 1212, 1605, 48, 133, "Input"],
Cell[49737, 1262, 4987, 148, 273, "Input"],
Cell[54727, 1412, 5383, 161, 293, "Input"],
Cell[60113, 1575, 2968, 89, 173, "Input"],
Cell[63084, 1666, 1279, 37, 133, "Input"],
Cell[64366, 1705, 1724, 51, 153, "Input"],
Cell[66093, 1758, 1276, 37, 133, "Input"],
Cell[67372, 1797, 1725, 51, 153, "Input"],
Cell[69100, 1850, 928, 27, 113, "Input"],
Cell[70031, 1879, 2205, 64, 173, "Input"],
Cell[72239, 1945, 2649, 78, 193, "Input"],
Cell[74891, 2025, 1036, 30, 113, "Input"],
Cell[75930, 2057, 2304, 67, 173, "Input"],
Cell[78237, 2126, 2753, 81, 193, "Input"],
Cell[80993, 2209, 1066, 31, 113, "Input"],
Cell[82062, 2242, 1093, 32, 113, "Input"],
Cell[83158, 2276, 2991, 85, 173, "Input"],
Cell[86152, 2363, 1593, 47, 133, "Input"],
Cell[87748, 2412, 1164, 32, 113, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88949, 2449, 108, 1, 35, "Subsection"],
Cell[89060, 2452, 7989, 255, 382, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97086, 2712, 103, 1, 35, "Subsection"],
Cell[97192, 2715, 8917, 211, 1073, "Input"],
Cell[106112, 2928, 25224, 616, 2133, "Input"],
Cell[131339, 3546, 902, 18, 113, "Input"],
Cell[132244, 3566, 737, 19, 113, "Input"],
Cell[132984, 3587, 1414, 33, 153, "Input"],
Cell[134401, 3622, 4623, 100, 653, "Input"],
Cell[139027, 3724, 1600, 34, 153, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140664, 3763, 95, 1, 35, "Subsection"],
Cell[140762, 3766, 1713, 33, 53, "Input"],
Cell[142478, 3801, 1511, 37, 53, "Input"],
Cell[143992, 3840, 595, 12, 32, "Input"],
Cell[144590, 3854, 669, 19, 53, "Input"],
Cell[145262, 3875, 500, 12, 53, "Input"],
Cell[145765, 3889, 3180, 58, 633, "Input"],
Cell[148948, 3949, 471, 12, 53, "Input"],
Cell[149422, 3963, 1442, 29, 133, "Input"],
Cell[150867, 3994, 549, 13, 93, "Input"],
Cell[151419, 4009, 969, 20, 173, "Input"],
Cell[152391, 4031, 884, 19, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153312, 4055, 97, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[153434, 4060, 105, 1, 21, "Subsubsection"],
Cell[153542, 4063, 263, 6, 53, "Input"],
Cell[153808, 4071, 1804, 35, 213, "Input"],
Cell[155615, 4108, 2021, 42, 293, "Input"],
Cell[157639, 4152, 1911, 36, 213, "Input"],
Cell[159553, 4190, 8071, 168, 673, "Input"],
Cell[167627, 4360, 6722, 142, 573, "Input"],
Cell[174352, 4504, 2130, 45, 293, "Input"],
Cell[176485, 4551, 1382, 29, 213, "Input"],
Cell[177870, 4582, 2137, 45, 293, "Input"],
Cell[180010, 4629, 1386, 29, 213, "Input"],
Cell[181399, 4660, 2765, 57, 373, "Input"],
Cell[184167, 4719, 2029, 41, 293, "Input"],
Cell[186199, 4762, 2766, 57, 373, "Input"],
Cell[188968, 4821, 2035, 41, 293, "Input"],
Cell[191006, 4864, 683, 15, 133, "Input"],
Cell[191692, 4881, 4321, 93, 413, "Input"],
Cell[196016, 4976, 1392, 29, 213, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197445, 5010, 107, 1, 21, "Subsubsection"],
Cell[197555, 5013, 563, 12, 113, "Input"],
Cell[198121, 5027, 716, 15, 113, "Input"],
Cell[198840, 5044, 4898, 101, 327, "Input"],
Cell[203741, 5147, 1342, 22, 113, "Input"],
Cell[205086, 5171, 511, 10, 113, "Input"],
Cell[205600, 5183, 945, 17, 213, "Input"],
Cell[206548, 5202, 227, 5, 53, "Input"],
Cell[206778, 5209, 2296, 42, 433, "Input"],
Cell[209077, 5253, 2205, 39, 353, "Input"],
Cell[211285, 5294, 8640, 159, 593, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219974, 5459, 94, 1, 35, "Subsection"],
Cell[220071, 5462, 7208, 118, 753, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[227328, 5586, 94, 1, 40, "Section"],
Cell[CellGroupData[{
Cell[227447, 5591, 98, 1, 32, "Input"],
Cell[227548, 5594, 63560, 1358, 465, "Output"]
}, {2}]]
}, Open  ]],
Cell[CellGroupData[{
Cell[291154, 6958, 101, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[291280, 6963, 318, 6, 19, "Reference"],
Cell[291601, 6971, 347, 6, 19, "Reference"],
Cell[291951, 6979, 172, 2, 19, "Reference"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
